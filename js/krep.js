// koffee 0.45.0

/*
000   000  00000000   00000000  00000000 
000  000   000   000  000       000   000
0000000    0000000    0000000   00000000 
000  000   000   000  000       000      
000   000  000   000  00000000  000
 */
var NEWLINE, _, args, colorize, fs, highlightRanges, ignoreDir, ignoreFile, karg, klog, klor, kolor, kstr, output, ref, search, slash, sliceRanges, valid;

ref = require('kxk'), slash = ref.slash, karg = ref.karg, klog = ref.klog, kstr = ref.kstr, valid = ref.valid, fs = ref.fs, _ = ref._;

klor = require('klor');

kolor = klor.kolor;

kolor.globalize();

args = karg("krep\n    strings   . ? text to search for                . **\n    path      . ? file or folder to search in       . = |.|\n    ext       . ? search only files with extension  . = ||\n    coffee    . ? search coffeescript files         . = true\n    noon      . ? search noon files                 . = true\n    js        . ? search javascript files           . = true\n    json      . ? search json files                 . = true  . - J\n    header    . ? print file headers                . = true  . - H\n    recurse   . ? recurse into subdirs              . = true  . - R\n    numbers   . ? prefix with line numbers          . = false . - N\n    regexp    . ? strings are regexp patterns       . = false\n    dot       . ? search dot files                  . = false\n    any       . ? search all text files             . = false\n    debug                                           . = false . - D\n\nversion       " + (require(__dirname + "/../package.json").version));

if (args.path === '.' && args.strings.length) {
    if (slash.exists(args.strings[0])) {
        if (args.strings.length > 1 || slash.isFile(args.strings[0])) {
            args.path = args.strings.shift();
        }
    } else if (slash.exists(args.strings.slice(-1)[0])) {
        args.path = args.strings.pop();
    }
}

args.path = slash.resolve(args.path);

if (valid(args.__ignored)) {
    args.strings = args.strings.concat(args.__ignored);
}

ignoreFile = function(p) {
    var base, ext;
    base = slash.basename(p);
    ext = slash.ext(p);
    if (slash.win()) {
        if (base[0] === '$') {
            return true;
        }
        if (base === 'desktop.ini') {
            return true;
        }
        if (base.toLowerCase().startsWith('ntuser')) {
            return true;
        }
    }
    if (p === args.path) {
        return false;
    }
    if (args.ext) {
        return ext !== args.ext;
    }
    if (base[0] === '.' && !args.dot) {
        return true;
    }
    if (args.any) {
        return false;
    }
    if (args.js && ext === 'js') {
        return false;
    }
    if (args.json && ext === 'json') {
        return false;
    }
    if (args.noon && ext === 'noon') {
        return false;
    }
    if (args.coffee && (ext === 'koffee' || ext === 'coffee')) {
        return false;
    }
    return true;
};

ignoreDir = function(p) {
    var base, ext;
    if (p === args.path) {
        return false;
    }
    base = slash.basename(p);
    ext = slash.ext(p);
    if (base[0] === '.') {
        return true;
    }
    if (base === 'node_modules') {
        return true;
    }
    if (ext === 'app') {
        return true;
    }
    return false;
};

NEWLINE = /\r?\n/;

search = function(paths) {
    var dump, regexp;
    if (args.strings.length) {
        if (args.regexp) {
            regexp = new RegExp("(" + args.strings.join('|') + ")", 'g');
        } else {
            regexp = new RegExp("(" + args.strings.map(function(s) {
                return kstr.escapeRegexp(s);
            }).join('|') + ")", 'g');
        }
    } else {
        dump = true;
    }
    return paths.forEach(function(path) {
        var dir, file, header, highlights, index, j, line, lines, printHeader, ref1, results, rngs, sliced, text;
        if (slash.isDir(path)) {
            dir = slash.resolve(path);
            if (!ignoreDir(dir)) {
                return search(fs.readdirSync(dir).map(function(p) {
                    return slash.join(dir, p);
                }));
            }
        } else if (slash.isText(path)) {
            file = slash.resolve(path);
            if (!ignoreFile(file)) {
                header = false;
                printHeader = function() {
                    var rel;
                    header = true;
                    if (args.header) {
                        rel = slash.relative(file, process.cwd());
                        console.log('');
                        console.log(W1(y5(' â–¸ ' + g2(slash.dirname(rel) + '/' + y5(slash.base(rel) + y1('.' + slash.ext(rel) + ' '))))));
                        return console.log('');
                    }
                };
                text = slash.readText(file);
                lines = text.split(NEWLINE);
                rngs = klor.dissect(lines, slash.ext(file));
                results = [];
                for (index = j = 0, ref1 = lines.length; 0 <= ref1 ? j < ref1 : j > ref1; index = 0 <= ref1 ? ++j : --j) {
                    line = lines[index];
                    if (line.startsWith('//# sourceMappingURL')) {
                        continue;
                    }
                    if (dump) {
                        if (!header) {
                            printHeader();
                        }
                        results.push(output(rngs[index], index + 1, []));
                    } else {
                        if (line.search(regexp) >= 0) {
                            if (!header) {
                                printHeader();
                            }
                            highlights = highlightRanges(line, regexp);
                            if (!(highlights.length)) {
                                console.log('[33m[93mkrep[33m[2m.[22m[2mcoffee[22m[39m[2m[34m:[39m[22m[94m144[39m', '[1m[97massertion failure![39m[22m');

                            };
                            sliced = sliceRanges(rngs[index], highlights);
                            results.push(output(sliced, index + 1, highlights));
                        } else {
                            results.push(void 0);
                        }
                    }
                }
                return results;
            }
        }
    });
};

highlightRanges = function(line, regexp) {
    var m, ranges;
    ranges = [];
    while (m = regexp.exec(line)) {
        ranges.push({
            start: m.index,
            end: m.index + m[0].length - 1
        });
    }
    return ranges;
};

sliceRanges = function(ranges, highlights) {
    var after, before, h, i, range, ref1, ref2, split;
    h = 0;
    i = 0;
    while (i < ranges.length) {
        range = ranges[i];
        while (h < highlights.length && range.start > highlights[h].end) {
            h++;
        }
        if (h >= highlights.length) {
            return ranges;
        }
        split = 0;
        if ((range.start < (ref1 = highlights[h].start) && ref1 <= range.start + range.length)) {
            split = highlights[h].start - range.start;
        } else if ((range.start <= (ref2 = highlights[h].end) && ref2 < range.start + range.length)) {
            split = highlights[h].end - range.start + 1;
        }
        if (split) {
            before = _.clone(range);
            after = _.clone(range);
            before.match = range.match.slice(0, split);
            before.length = before.match.length;
            after.match = range.match.slice(split);
            after.length = after.match.length;
            after.start = range.start + before.length;
            ranges.splice(i, 1, before, after);
        }
        i++;
    }
    return ranges;
};

output = function(rngs, number, highlights) {
    var c, clrzd, h, highlight, i, j, numstr, ref1;
    clrzd = '';
    if (args.numbers) {
        numstr = String(number);
        clrzd += w1(numstr) + _.pad('', 4 - numstr.length);
    }
    c = 0;
    h = 0;
    highlight = function(s) {
        if (h < highlights.length) {
            if (c >= highlights[h].start && c <= highlights[h].end) {
                return inverse(s);
            }
            while (h < highlights.length && c > highlights[h].end) {
                h++;
            }
        }
        return s;
    };
    for (i = j = 0, ref1 = rngs.length; 0 <= ref1 ? j < ref1 : j > ref1; i = 0 <= ref1 ? ++j : --j) {
        while (c < rngs[i].start) {
            clrzd += highlight(' ');
            c++;
        }
        clrzd += highlight(colorize(rngs[i]));
        c += rngs[i].match.length;
    }
    return console.log(clrzd);
};

colorize = function(chunk) {
    var c, cn, j, len, v;
    if (cn = kolor.map[chunk.value]) {
        if (cn instanceof Array) {
            v = chunk.match;
            for (j = 0, len = cn.length; j < len; j++) {
                c = cn[j];
                v = kolor[c](v);
            }
            return v;
        } else {
            return kolor[cn](chunk.match);
        }
    }
    if (chunk.value.endsWith('file')) {
        return w8(chunk.match);
    } else if (chunk.value.endsWith('ext')) {
        return w2(chunk.match);
    } else if (chunk.value.startsWith('punct')) {
        return w1(chunk.match);
    } else {
        console.log(">>>" + chunk.value);
        return chunk.match;
    }
};

if (args.debug) {
    klog('args:', args);
}

search([args.path]);

console.log('');

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia3JlcC5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUE7O0FBUUEsTUFBNEMsT0FBQSxDQUFRLEtBQVIsQ0FBNUMsRUFBRSxpQkFBRixFQUFTLGVBQVQsRUFBZSxlQUFmLEVBQXFCLGVBQXJCLEVBQTJCLGlCQUEzQixFQUFrQyxXQUFsQyxFQUFzQzs7QUFFdEMsSUFBQSxHQUFRLE9BQUEsQ0FBUSxNQUFSOztBQUVSLEtBQUEsR0FBUSxJQUFJLENBQUM7O0FBQ2IsS0FBSyxDQUFDLFNBQU4sQ0FBQTs7QUFFQSxJQUFBLEdBQU8sSUFBQSxDQUFLLDI1QkFBQSxHQWlCRyxDQUFDLE9BQUEsQ0FBVyxTQUFELEdBQVcsa0JBQXJCLENBQXVDLENBQUMsT0FBekMsQ0FqQlI7O0FBb0JQLElBQUcsSUFBSSxDQUFDLElBQUwsS0FBYSxHQUFiLElBQXFCLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBckM7SUFDSSxJQUFHLEtBQUssQ0FBQyxNQUFOLENBQWEsSUFBSSxDQUFDLE9BQVEsQ0FBQSxDQUFBLENBQTFCLENBQUg7UUFDSSxJQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBYixHQUFzQixDQUF0QixJQUEyQixLQUFLLENBQUMsTUFBTixDQUFhLElBQUksQ0FBQyxPQUFRLENBQUEsQ0FBQSxDQUExQixDQUE5QjtZQUNJLElBQUksQ0FBQyxJQUFMLEdBQVksSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFiLENBQUEsRUFEaEI7U0FESjtLQUFBLE1BR0ssSUFBRyxLQUFLLENBQUMsTUFBTixDQUFhLElBQUksQ0FBQyxPQUFRLFVBQUUsQ0FBQSxDQUFBLENBQTVCLENBQUg7UUFDRCxJQUFJLENBQUMsSUFBTCxHQUFZLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBYixDQUFBLEVBRFg7S0FKVDs7O0FBT0EsSUFBSSxDQUFDLElBQUwsR0FBWSxLQUFLLENBQUMsT0FBTixDQUFjLElBQUksQ0FB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QUEsQ0FBQyxHQUFELENBQUssS0FBQSxHQUFNLEtBQUssQ0FBQyxLQUFqQjtlQUNDLEtBQUssQ0FBQyxNQUpMOztBQWRFOztBQW9CWCxJQUFxQixJQUFJLENBQUMsS0FBMUI7SUFBQSxJQUFBLENBQUssT0FBTCxFQUFhLElBQWIsRUFBQTs7O0FBRUEsTUFBQSxDQUFPLENBQUMsSUFBSSxDQUFDLElBQU4sQ0FBUDs7QUFBa0IsT0FBQSxDQUNsQixHQURrQixDQUNkLEVBRGMiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbjAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMDAgXG4wMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMFxuMDAwMDAwMCAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwMCBcbjAwMCAgMDAwICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgICAgIFxuIyMjXG5cbnsgc2xhc2gsIGthcmcsIGtsb2csIGtzdHIsIHZhbGlkLCBmcywgXyB9ID0gcmVxdWlyZSAna3hrJ1xuXG5rbG9yICA9IHJlcXVpcmUgJ2tsb3InXG5cbmtvbG9yID0ga2xvci5rb2xvclxua29sb3IuZ2xvYmFsaXplKClcblxuYXJncyA9IGthcmcgXCJcIlwiXG5rcmVwXG4gICAgc3RyaW5ncyAgIC4gPyB0ZXh0IHRvIHNlYXJjaCBmb3IgICAgICAgICAgICAgICAgLiAqKlxuICAgIHBhdGggICAgICAuID8gZmlsZSBvciBmb2xkZXIgdG8gc2VhcmNoIGluICAgICAgIC4gPSB8LnxcbiAgICBleHQgICAgICAgLiA/IHNlYXJjaCBvbmx5IGZpbGVzIHdpdGggZXh0ZW5zaW9uICAuID0gfHxcbiAgICBjb2ZmZWUgICAgLiA/IHNlYXJjaCBjb2ZmZWVzY3JpcHQgZmlsZXMgICAgICAgICAuID0gdHJ1ZVxuICAgIG5vb24gICAgICAuID8gc2VhcmNoIG5vb24gZmlsZXMgICAgICAgICAgICAgICAgIC4gPSB0cnVlXG4gICAganMgICAgICAgIC4gPyBzZWFyY2ggamF2YXNjcmlwdCBmaWxlcyAgICAgICAgICAgLiA9IHRydWVcbiAgICBqc29uICAgICAgLiA/IHNlYXJjaCBqc29uIGZpbGVzICAgICAgICAgICAgICAgICAuID0gdHJ1ZSAgLiAtIEpcbiAgICBoZWFkZXIgICAgLiA/IHByaW50IGZpbGUgaGVhZGVycyAgICAgICAgICAgICAgICAuID0gdHJ1ZSAgLiAtIEhcbiAgICByZWN1cnNlICAgLiA/IHJlY3Vyc2UgaW50byBzdWJkaXJzICAgICAgICAgICAgICAuID0gdHJ1ZSAgLiAtIFJcbiAgICBudW1iZXJzICAgLiA/IHByZWZpeCB3aXRoIGxpbmUgbnVtYmVycyAgICAgICAgICAuID0gZmFsc2UgLiAtIE5cbiAgICByZWdleHAgICAgLiA/IHN0cmluZ3MgYXJlIHJlZ2V4cCBwYXR0ZXJucyAgICAgICAuID0gZmFsc2VcbiAgICBkb3QgICAgICAgLiA/IHNlYXJjaCBkb3QgZmlsZXMgICAgICAgICAgICAgICAgICAuID0gZmFsc2VcbiAgICBhbnkgICAgICAgLiA/IHNlYXJjaCBhbGwgdGV4dCBmaWxlcyAgICAgICAgICAgICAuID0gZmFsc2VcbiAgICBkZWJ1ZyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuID0gZmFsc2UgLiAtIERcblxudmVyc2lvbiAgICAgICAje3JlcXVpcmUoXCIje19fZGlybmFtZX0vLi4vcGFja2FnZS5qc29uXCIpLnZlcnNpb259XG5cIlwiXCJcblxuaWYgYXJncy5wYXRoID09ICcuJyBhbmQgYXJncy5zdHJpbmdzLmxlbmd0aFxuICAgIGlmIHNsYXNoLmV4aXN0cyBhcmdzLnN0cmluZ3NbMF1cbiAgICAgICAgaWYgYXJncy5zdHJpbmdzLmxlbmd0aCA+IDEgb3Igc2xhc2guaXNGaWxlIGFyZ3Muc3RyaW5nc1swXVxuICAgICAgICAgICAgYXJncy5wYXRoID0gYXJncy5zdHJpbmdzLnNoaWZ0KClcbiAgICBlbHNlIGlmIHNsYXNoLmV4aXN0cyBhcmdzLnN0cmluZ3NbLTFdXG4gICAgICAgIGFyZ3MucGF0aCA9IGFyZ3Muc3RyaW5ncy5wb3AoKVxuICAgICAgICBcbmFyZ3MucGF0aCA9IHNsYXNoLnJlc29sdmUgYXJncy5wYXRoXG5cbmlmIHZhbGlkIGFyZ3MuX19pZ25vcmVkXG4gICAgYXJncy5zdHJpbmdzID0gYXJncy5zdHJpbmdzLmNvbmNhdCBhcmdzLl9faWdub3JlZFxuICAgIFxuIyBsb2cgYXJnc1xuXG4jIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAwMDAwMCAgXG4jIDAwMCAgMDAwICAgICAgICAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgXG4jIDAwMCAgMDAwICAwMDAwICAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwICAgXG4jIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgXG4jIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMCAgXG5cbmlnbm9yZUZpbGUgPSAocCkgLT5cbiAgICBcbiAgICBiYXNlID0gc2xhc2guYmFzZW5hbWUgcFxuICAgIGV4dCAgPSBzbGFzaC5leHQgcFxuICAgIFxuICAgIGlmIHNsYXNoLndpbigpXG4gICAgICAgIHJldHVybiB0cnVlIGlmIGJhc2VbMF0gPT0gJyQnXG4gICAgICAgIHJldHVybiB0cnVlIGlmIGJhc2UgPT0gJ2Rlc2t0b3AuaW5pJ1xuICAgICAgICByZXR1cm4gdHJ1ZSBpZiBiYXNlLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCAnbnR1c2VyJ1xuICAgIFxuICAgIHJldHVybiBmYWxzZSBpZiBwID09IGFyZ3MucGF0aFxuICAgIGlmIGFyZ3MuZXh0IHRoZW4gcmV0dXJuIGV4dCAhPSBhcmdzLmV4dFxuICAgIHJldHVybiB0cnVlIGlmIGJhc2VbMF0gPT0gJy4nIGFuZCBub3QgYXJncy5kb3RcbiAgICByZXR1cm4gZmFsc2UgaWYgYXJncy5hbnlcbiAgICByZXR1cm4gZmFsc2UgaWYgYXJncy5qcyAgICAgYW5kIGV4dCA9PSAnanMnXG4gICAgcmV0dXJuIGZhbHNlIGlmIGFyZ3MuanNvbiAgIGFuZCBleHQgPT0gJ2pzb24nXG4gICAgcmV0dXJuIGZhbHNlIGlmIGFyZ3Mubm9vbiAgIGFuZCBleHQgPT0gJ25vb24nXG4gICAgcmV0dXJuIGZhbHNlIGlmIGFyZ3MuY29mZmVlIGFuZCBleHQgaW4gWydrb2ZmZWUnJ2NvZmZlZSddXG4gICAgcmV0dXJuIHRydWVcblxuaWdub3JlRGlyID0gKHApIC0+XG4gICAgXG4gICAgcmV0dXJuIGZhbHNlIGlmIHAgPT0gYXJncy5wYXRoXG4gICAgYmFzZSA9IHNsYXNoLmJhc2VuYW1lIHBcbiAgICBleHQgID0gc2xhc2guZXh0IHBcbiAgICByZXR1cm4gdHJ1ZSBpZiBiYXNlWzBdID09ICcuJ1xuICAgIHJldHVybiB0cnVlIGlmIGJhc2UgPT0gJ25vZGVfbW9kdWxlcydcbiAgICByZXR1cm4gdHJ1ZSBpZiBleHQgID09ICdhcHAnXG4gICAgZmFsc2VcbiAgICAgICAgICAgICAgICBcbiMgIDAwMDAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4jIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIFxuIyAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgICAwMDAgICAgICAgMDAwMDAwMDAwICBcbiMgICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4jIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAwMDAgICAwMDAgIFxuXG5ORVdMSU5FID0gL1xccj9cXG4vXG5cbnNlYXJjaCA9IChwYXRocykgLT5cbiAgICBcbiAgICBpZiBhcmdzLnN0cmluZ3MubGVuZ3RoXG4gICAgICAgIGlmIGFyZ3MucmVnZXhwXG4gICAgICAgICAgICByZWdleHAgPSBuZXcgUmVnRXhwIFwiKFwiICsgYXJncy5zdHJpbmdzLmpvaW4oJ3wnKSArIFwiKVwiLCAnZydcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cCBcIihcIiArIGFyZ3Muc3RyaW5ncy5tYXAoKHMpIC0+IGtzdHIuZXNjYXBlUmVnZXhwKHMpKS5qb2luKCd8JykgKyBcIilcIiwgJ2cnXG4gICAgZWxzZVxuICAgICAgICBkdW1wID0gdHJ1ZVxuXG4gICAgcGF0aHMuZm9yRWFjaCAocGF0aCkgLT5cbiAgICAgICAgXG4gICAgICAgIGlmIHNsYXNoLmlzRGlyIHBhdGhcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZGlyID0gc2xhc2gucmVzb2x2ZSBwYXRoXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIG5vdCBpZ25vcmVEaXIgZGlyXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgc2VhcmNoIGZzLnJlYWRkaXJTeW5jKGRpcikubWFwIChwKSAtPiBzbGFzaC5qb2luIGRpciwgcFxuICAgICAgICAgICAgXG4gICAgICAgIGVsc2UgaWYgc2xhc2guaXNUZXh0IHBhdGhcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZmlsZSA9IHNsYXNoLnJlc29sdmUgcGF0aFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiBub3QgaWdub3JlRmlsZSBmaWxlXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaGVhZGVyID0gZmFsc2VcbiAgICAgICAgICAgICAgICBwcmludEhlYWRlciA9IC0+XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgaWYgYXJncy5oZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbCA9IHNsYXNoLnJlbGF0aXZlIGZpbGUsIHByb2Nlc3MuY3dkKClcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZyAnJ1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nIFcxIHk1ICcg4pa4ICcgKyBnMiBzbGFzaC5kaXJuYW1lKHJlbCkgKyAnLycgKyB5NSBzbGFzaC5iYXNlKHJlbCkgKyB5MSAnLicgKyBzbGFzaC5leHQocmVsKSArICcgJ1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nICcnXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGV4dCAgPSBzbGFzaC5yZWFkVGV4dCBmaWxlXG4gICAgICAgICAgICAgICAgbGluZXMgPSB0ZXh0LnNwbGl0IE5FV0xJTkVcbiAgICAgICAgICAgICAgICBybmdzICA9IGtsb3IuZGlzc2VjdCBsaW5lcywgc2xhc2guZXh0IGZpbGVcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBmb3IgaW5kZXggaW4gWzAuLi5saW5lcy5sZW5ndGhdXG4gICAgICAgICAgICAgICAgICAgIGxpbmUgPSBsaW5lc1tpbmRleF1cbiAgICAgICAgICAgICAgICAgICAgaWYgbGluZS5zdGFydHNXaXRoICcvLyMgc291cmNlTWFwcGluZ1VSTCdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgICAgICAgICAgICAgIGlmIGR1bXBcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50SGVhZGVyKCkgaWYgbm90IGhlYWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0IHJuZ3NbaW5kZXhdLCBpbmRleCsxLCBbXVxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiBsaW5lLnNlYXJjaChyZWdleHApID49IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludEhlYWRlcigpIGlmIG5vdCBoZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRzID0gaGlnaGxpZ2h0UmFuZ2VzIGxpbmUsIHJlZ2V4cFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKWuGFzc2VydCBoaWdobGlnaHRzLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWNlZCA9IHNsaWNlUmFuZ2VzIHJuZ3NbaW5kZXhdLCBoaWdobGlnaHRzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0IHNsaWNlZCwgaW5kZXgrMSwgaGlnaGxpZ2h0c1xuXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG4jIDAwMDAwMDAwMCAgMDAwICAwMDAgIDAwMDAgIDAwMDAwMDAwMCAgMDAwICAgICAgMDAwICAwMDAgIDAwMDAgIDAwMDAwMDAwMCAgICAgMDAwICAgXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG5cbmhpZ2hsaWdodFJhbmdlcyA9IChsaW5lLCByZWdleHApIC0+XG4gICAgXG4gICAgcmFuZ2VzID0gW11cbiAgICB3aGlsZSBtID0gcmVnZXhwLmV4ZWMgbGluZVxuICAgICAgICByYW5nZXMucHVzaCBzdGFydDptLmluZGV4LCBlbmQ6bS5pbmRleCttWzBdLmxlbmd0aC0xXG4gICAgcmFuZ2VzXG4gICAgXG5zbGljZVJhbmdlcyA9IChyYW5nZXMsIGhpZ2hsaWdodHMpIC0+XG5cbiAgICBoID0gMFxuICAgIGkgPSAwXG4gICAgd2hpbGUgaSA8IHJhbmdlcy5sZW5ndGhcbiAgICAgICAgcmFuZ2UgPSByYW5nZXNbaV1cbiAgICAgICAgd2hpbGUgaCA8IGhpZ2hsaWdodHMubGVuZ3RoIGFuZCByYW5nZS5zdGFydCA+IGhpZ2hsaWdodHNbaF0uZW5kXG4gICAgICAgICAgICBoKytcbiAgICAgICAgXG4gICAgICAgIGlmIGggPj0gaGlnaGxpZ2h0cy5sZW5ndGggdGhlbiByZXR1cm4gcmFuZ2VzXG5cbiAgICAgICAgc3BsaXQgPSAwXG4gICAgICAgIGlmIHJhbmdlLnN0YXJ0IDwgaGlnaGxpZ2h0c1toXS5zdGFydCA8PSByYW5nZS5zdGFydCtyYW5nZS5sZW5ndGhcbiAgICAgICAgICAgIHNwbGl0ICA9IGhpZ2hsaWdodHNbaF0uc3RhcnQgLSByYW5nZS5zdGFydFxuICAgICAgICBlbHNlIGlmIHJhbmdlLnN0YXJ0IDw9IGhpZ2hsaWdodHNbaF0uZW5kIDwgcmFuZ2Uuc3RhcnQrcmFuZ2UubGVuZ3RoXG4gICAgICAgICAgICBzcGxpdCA9IGhpZ2hsaWdodHNbaF0uZW5kIC0gcmFuZ2Uuc3RhcnQgKyAxXG5cbiAgICAgICAgaWYgc3BsaXRcbiAgICAgICAgICAgIGJlZm9yZSA9IF8uY2xvbmUgcmFuZ2VcbiAgICAgICAgICAgIGFmdGVyICA9IF8uY2xvbmUgcmFuZ2VcbiAgICAgICAgICAgIGJlZm9yZS5tYXRjaCAgPSByYW5nZS5tYXRjaFsuLi5zcGxpdF1cbiAgICAgICAgICAgIGJlZm9yZS5sZW5ndGggPSBiZWZvcmUubWF0Y2gubGVuZ3RoXG4gICAgICAgICAgICBhZnRlci5tYXRjaCAgID0gcmFuZ2UubWF0Y2hbc3BsaXQuLi5dXG4gICAgICAgICAgICBhZnRlci5sZW5ndGggID0gYWZ0ZXIubWF0Y2gubGVuZ3RoXG4gICAgICAgICAgICBhZnRlci5zdGFydCAgID0gcmFuZ2Uuc3RhcnQgKyBiZWZvcmUubGVuZ3RoXG4gICAgICAgICAgICByYW5nZXMuc3BsaWNlIGksIDEsIGJlZm9yZSwgYWZ0ZXJcbiAgICAgICAgaSsrXG4gICAgcmFuZ2VzXG4gICAgICAgICAgICBcbiMgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgXG4jICAwMDAwMDAwICAgIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMCAgICAgICAgIDAwMDAwMDAgICAgICAwMDAgICAgIFxuXG5vdXRwdXQgPSAocm5ncywgbnVtYmVyLCBoaWdobGlnaHRzKSAtPlxuICAgIFxuICAgIGNscnpkID0gJydcbiAgICBcbiAgICBpZiBhcmdzLm51bWJlcnNcbiAgICAgICAgbnVtc3RyID0gU3RyaW5nIG51bWJlclxuICAgICAgICBjbHJ6ZCArPSB3MShudW1zdHIpICsgXy5wYWQgJycsIDQtbnVtc3RyLmxlbmd0aFxuICAgICAgICBcbiAgICBjID0gMFxuICAgIGggPSAwXG4gICAgaGlnaGxpZ2h0ID0gKHMpIC0+XG4gICAgICAgIGlmIGggPCBoaWdobGlnaHRzLmxlbmd0aFxuICAgICAgICAgICAgaWYgYyA+PSBoaWdobGlnaHRzW2hdLnN0YXJ0IGFuZCBjIDw9IGhpZ2hsaWdodHNbaF0uZW5kXG4gICAgICAgICAgICAgICAgcmV0dXJuIGludmVyc2Ugc1xuICAgICAgICAgICAgd2hpbGUgaCA8IGhpZ2hsaWdodHMubGVuZ3RoIGFuZCBjID4gaGlnaGxpZ2h0c1toXS5lbmRcbiAgICAgICAgICAgICAgICBoKytcbiAgICAgICAgc1xuICAgIFxuICAgIGZvciBpIGluIFswLi4ucm5ncy5sZW5ndGhdXG4gICAgICAgIHdoaWxlIGMgPCBybmdzW2ldLnN0YXJ0IFxuICAgICAgICAgICAgY2xyemQgKz0gaGlnaGxpZ2h0ICcgJ1xuICAgICAgICAgICAgYysrXG4gICAgICAgIGNscnpkICs9IGhpZ2hsaWdodCBjb2xvcml6ZSBybmdzW2ldXG4gICAgICAgIGMgKz0gcm5nc1tpXS5tYXRjaC5sZW5ndGhcbiAgICAgICAgXG4gICAgbG9nIGNscnpkXG5cbiMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgICAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMCAgMDAwMDAwMCAgMDAwMDAwMDAgIFxuIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAwMDAgICAwMDAgICAgICAgXG4jIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAgICAgMDAwICAgIDAwMDAwMDAgICBcbiMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAgIFxuIyAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgXG5cbmNvbG9yaXplID0gKGNodW5rKSAtPiBcblxuICAgIGlmIGNuID0ga29sb3IubWFwW2NodW5rLnZhbHVlXVxuICAgICAgICBpZiBjbiBpbnN0YW5jZW9mIEFycmF5XG4gICAgICAgICAgICB2ID0gY2h1bmsubWF0Y2hcbiAgICAgICAgICAgIGZvciBjIGluIGNuXG4gICAgICAgICAgICAgICAgdiA9IGtvbG9yW2NdIHZcbiAgICAgICAgICAgIHJldHVybiB2XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiBrb2xvcltjbl0gY2h1bmsubWF0Y2hcbiAgICBpZiBjaHVuay52YWx1ZS5lbmRzV2l0aCAnZmlsZSdcbiAgICAgICAgdzggY2h1bmsubWF0Y2hcbiAgICBlbHNlIGlmIGNodW5rLnZhbHVlLmVuZHNXaXRoICdleHQnXG4gICAgICAgIHcyIGNodW5rLm1hdGNoXG4gICAgZWxzZSBpZiBjaHVuay52YWx1ZS5zdGFydHNXaXRoICdwdW5jdCdcbiAgICAgICAgdzEgY2h1bmsubWF0Y2hcbiAgICBlbHNlXG4gICAgICAgIGxvZyBcIj4+PiN7Y2h1bmsudmFsdWV9XCJcbiAgICAgICAgY2h1bmsubWF0Y2hcbiAgICBcbmtsb2cgJ2FyZ3M6JyBhcmdzIGlmIGFyZ3MuZGVidWdcblxuc2VhcmNoIFthcmdzLnBhdGhdXG5sb2cgJydcbiJdfQ==
//# sourceURL=../coffee/krep.coffee
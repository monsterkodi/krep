// koffee 0.45.0

/*
000   000  00000000   00000000  00000000 
000  000   000   000  000       000   000
0000000    0000000    0000000   00000000 
000  000   000   000  000       000      
000   000  000   000  00000000  000
 */
var NEWLINE, _, args, childp, colorize, fs, ignoreDir, ignoreFile, karg, klog, klor, kolor, kstr, output, ref, search, slash;

ref = require('kxk'), childp = ref.childp, slash = ref.slash, karg = ref.karg, klog = ref.klog, kstr = ref.kstr, fs = ref.fs, _ = ref._;

kolor = require('./kolor');

klor = require('klor');

kolor.globalize();

args = karg("krep\n    strings   . ? text to search for              . **\n    path      . ? file or folder to search in     . = |.|\n    coffee    . ? search coffeescript files       . = true\n    noon      . ? search noon files               . = true\n    js        . ? search javascript files         . = true\n    json      . ? search json files               . = true  . - J\n    header    . ? print file headers              . = true  . - H\n    recurse   . ? recurse into subdirs            . = true  . - R\n    numbers   . ? prefix with line numbers        . = false . - N\n    regexp    . ? strings are regexp patterns     . = false\n    dot       . ? search dot files                . = false\n    any       . ? search all text files           . = false\n    debug                                         . = false . - D\n\nversion      " + (require(__dirname + "/../package.json").version));

if (args.path === '.' && args.strings.length) {
    if (slash.exists(args.strings[0])) {
        args.path = args.strings.shift();
    } else if (slash.exists(args.strings.slice(-1)[0])) {
        args.path = args.strings.pop();
    }
}

args.path = slash.resolve(args.path);

ignoreFile = function(p) {
    var base, ext;
    base = slash.basename(p);
    ext = slash.ext(p);
    if (slash.win()) {
        if (base[0] === '$') {
            return true;
        }
        if (base === 'desktop.ini') {
            return true;
        }
        if (base.toLowerCase().startsWith('ntuser')) {
            return true;
        }
    }
    if (p === args.path) {
        return false;
    }
    if (base[0] === '.' && !args.dot) {
        return true;
    }
    if (args.any) {
        return false;
    }
    if (args.js && ext === 'js') {
        return false;
    }
    if (args.json && ext === 'json') {
        return false;
    }
    if (args.noon && ext === 'noon') {
        return false;
    }
    if (args.coffee && (ext === 'koffee' || ext === 'coffee')) {
        return false;
    }
    return true;
};

ignoreDir = function(p) {
    var base, ext;
    if (p === args.path) {
        return false;
    }
    base = slash.basename(p);
    ext = slash.ext(p);
    if (base[0] === '.') {
        return true;
    }
    if (base === 'node_modules') {
        return true;
    }
    if (ext === 'app') {
        return true;
    }
    return false;
};

NEWLINE = /\r?\n/;

search = function(paths) {
    var regexp;
    regexp = new RegExp("(" + args.strings.map(function(s) {
        return kstr.escapeRegexp(s);
    }).join('|') + ")", 'g');
    return paths.forEach(function(path) {
        var dir, file, header, index, j, line, lines, printHeader, ref1, results, rngs, text;
        if (slash.isDir(path)) {
            dir = slash.resolve(path);
            if (!ignoreDir(dir)) {
                return search(fs.readdirSync(dir).map(function(p) {
                    return slash.join(dir, p);
                }));
            }
        } else if (slash.isText(path)) {
            file = slash.resolve(path);
            if (!ignoreFile(file)) {
                header = false;
                printHeader = function() {
                    var rel;
                    header = true;
                    if (args.header) {
                        rel = slash.relative(file, process.cwd());
                        console.log('');
                        console.log(W1(g3(' â–¸ ' + slash.dirname(rel) + '/' + y6(slash.base(rel) + y2('.' + slash.ext(rel) + ' ')))));
                        return console.log('');
                    }
                };
                text = slash.readText(file);
                lines = text.split(NEWLINE);
                rngs = klor.dissect(lines, 'coffee');
                results = [];
                for (index = j = 0, ref1 = lines.length; 0 <= ref1 ? j < ref1 : j > ref1; index = 0 <= ref1 ? ++j : --j) {
                    line = lines[index];
                    if (line.search(regexp) >= 0) {
                        if (!header) {
                            printHeader();
                        }
                        results.push(output(rngs[index], index + 1));
                    } else {
                        results.push(void 0);
                    }
                }
                return results;
            }
        }
    });
};

output = function(rngs, number) {
    var c, clrzd, i, j, ref1;
    c = 0;
    clrzd = '';
    if (args.numbers) {
        clrzd += w2("" + number) + w1(':');
    }
    for (i = j = 0, ref1 = rngs.length; 0 <= ref1 ? j < ref1 : j > ref1; i = 0 <= ref1 ? ++j : --j) {
        while (c < rngs[i].start) {
            c++;
            clrzd += ' ';
        }
        clrzd += colorize(rngs[i]);
        c += rngs[i].match.length;
    }
    return console.log(clrzd);
};

colorize = function(chunk) {
    var c, cn, j, len, v;
    if (cn = kolor.map[chunk.value]) {
        if (cn instanceof Array) {
            v = chunk.match;
            for (j = 0, len = cn.length; j < len; j++) {
                c = cn[j];
                v = kolor[c](v);
            }
            return v;
        } else {
            return kolor[cn](chunk.match);
        }
    }
    return chunk.match;
};

if (args.debug) {
    klog('args:', args);
}

search([args.path]);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia3JlcC5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUE7O0FBUUEsTUFBNkMsT0FBQSxDQUFRLEtBQVIsQ0FBN0MsRUFBRSxtQkFBRixFQUFVLGlCQUFWLEVBQWlCLGVBQWpCLEVBQXVCLGVBQXZCLEVBQTZCLGVBQTdCLEVBQW1DLFdBQW5DLEVBQXVDOztBQUV2QyxLQUFBLEdBQVEsT0FBQSxDQUFRLFNBQVI7O0FBQ1IsSUFBQSxHQUFRLE9BQUEsQ0FBUSxNQUFSOztBQUVSLEtBQUssQ0FBQyxTQUFOLENBQUE7O0FBUUEsSUFBQSxHQUFPLElBQUEsQ0FBSyxvMEJBQUEsR0FnQkUsQ0FBQyxPQUFBLENBQVcsU0FBRCxHQUFXLGtCQUFyQixDQUF1QyxDQUFDLE9BQXpDLENBaEJQOztBQW1CUCxJQUFHLElBQUksQ0FBQyxJQUFMLEtBQWEsR0FBYixJQUFxQixJQUFJLENBQUMsT0FBTyxDQUFDLE1BQXJDO0lBQ0ksSUFBRyxLQUFLLENBQUMsTUFBTixDQUFhLElBQUksQ0FBQyxPQUFRLENBQUEsQ0FBQSxDQUExQixDQUFIO1FBQ0ksSUFBSSxDQUFDLElBQUwsR0FBWSxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQWIsQ0FBQSxFQURoQjtLQUFBLE1BRUssSUFBRyxLQUFLLENBQUMsTUFBTixDQUFhLElBQUksQ0FBQyxPQUFRLFVBQUUsQ0FBQSxDQUFBLENBQTVCLENBQUg7UUFDRCxJQUFJLENBQUMsSUFBTCxHQUFZLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBYixDQUFBLEVBRFg7S0FIVDs7O0FBTUEsSUFBSSxDQUFDLElBQUwsR0FBWSxLQUFLLENBQUMsT0FBTixDQUFjLElBQUksQ0FBQyxJQUFuQjs7QUFRWixVQUFBLEdBQWEsU0FBQyxDQUFEO0FBRVQsUUFBQTtJQUFBLElBQUEsR0FBTyxLQUFLLENBQUMsUUFBTixDQUFlLENBQWY7SUFDUCxHQUFBLEdBQU8sS0FBSyxDQUFD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LENBQUcsRUFBQSxHQUFHLE1BQU4sQ0FBQSxHQUFrQixFQUFBLENBQUcsR0FBSCxFQUQvQjs7QUFFQSxTQUFTLHlGQUFUO0FBQ0ksZUFBTSxDQUFBLEdBQUksSUFBSyxDQUFBLENBQUEsQ0FBRSxDQUFDLEtBQWxCO1lBQ0ksQ0FBQTtZQUNBLEtBQUEsSUFBUztRQUZiO1FBR0EsS0FBQSxJQUFTLFFBQUEsQ0FBUyxJQUFLLENBQUEsQ0FBQSxDQUFkO1FBQ1QsQ0FBQSxJQUFLLElBQUssQ0FBQSxDQUFBLENBQUUsQ0FBQyxLQUFLLENBQUM7QUFMdkI7V0FNQSxPQUFBLENBQUEsR0FBQSxDQUFJLEtBQUo7QUFaSzs7QUFvQlQsUUFBQSxHQUFXLFNBQUMsS0FBRDtBQUVQLFFBQUE7SUFBQSxJQUFHLEVBQUEsR0FBSyxLQUFLLENBQUMsR0FBSSxDQUFBLEtBQUssQ0FBQyxLQUFOLENBQWxCO1FBQ0ksSUFBRyxFQUFBLFlBQWMsS0FBakI7WUFDSSxDQUFBLEdBQUksS0FBSyxDQUFDO0FBQ1YsaUJBQUEsb0NBQUE7O2dCQUNJLENBQUEsR0FBSSxLQUFNLENBQUEsQ0FBQSxDQUFOLENBQVMsQ0FBVDtBQURSO0FBRUEsbUJBQU8sRUFKWDtTQUFBLE1BQUE7QUFNSSxtQkFBTyxLQUFNLENBQUEsRUFBQSxDQUFOLENBQVUsS0FBSyxDQUFDLEtBQWhCLEVBTlg7U0FESjs7V0FRQSxLQUFLLENBQUM7QUFWQzs7QUFrQlgsSUFBcUIsSUFBSSxDQUFDLEtBQTFCO0lBQUEsSUFBQSxDQUFLLE9BQUwsRUFBYSxJQUFiLEVBQUE7OztBQUVBLE1BQUEsQ0FBTyxDQUFDLElBQUksQ0FBQyxJQUFOLENBQVAiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbjAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMDAgXG4wMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMFxuMDAwMDAwMCAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwMCBcbjAwMCAgMDAwICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgICAgIFxuIyMjXG5cbnsgY2hpbGRwLCBzbGFzaCwga2FyZywga2xvZywga3N0ciwgZnMsIF8gfSA9IHJlcXVpcmUgJ2t4aydcblxua29sb3IgPSByZXF1aXJlICcuL2tvbG9yJ1xua2xvciAgPSByZXF1aXJlICdrbG9yJ1xuXG5rb2xvci5nbG9iYWxpemUoKVxuXG4jICAwMDAwMDAwICAgMDAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMFxuIyAwMDAwMDAwMDAgIDAwMDAwMDAgICAgMDAwICAwMDAwICAwMDAwMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgICAgMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDBcblxuYXJncyA9IGthcmcgXCJcIlwiXG5rcmVwXG4gICAgc3RyaW5ncyAgIC4gPyB0ZXh0IHRvIHNlYXJjaCBmb3IgICAgICAgICAgICAgIC4gKipcbiAgICBwYXRoICAgICAgLiA/IGZpbGUgb3IgZm9sZGVyIHRvIHNlYXJjaCBpbiAgICAgLiA9IHwufFxuICAgIGNvZmZlZSAgICAuID8gc2VhcmNoIGNvZmZlZXNjcmlwdCBmaWxlcyAgICAgICAuID0gdHJ1ZVxuICAgIG5vb24gICAgICAuID8gc2VhcmNoIG5vb24gZmlsZXMgICAgICAgICAgICAgICAuID0gdHJ1ZVxuICAgIGpzICAgICAgICAuID8gc2VhcmNoIGphdmFzY3JpcHQgZmlsZXMgICAgICAgICAuID0gdHJ1ZVxuICAgIGpzb24gICAgICAuID8gc2VhcmNoIGpzb24gZmlsZXMgICAgICAgICAgICAgICAuID0gdHJ1ZSAgLiAtIEpcbiAgICBoZWFkZXIgICAgLiA/IHByaW50IGZpbGUgaGVhZGVycyAgICAgICAgICAgICAgLiA9IHRydWUgIC4gLSBIXG4gICAgcmVjdXJzZSAgIC4gPyByZWN1cnNlIGludG8gc3ViZGlycyAgICAgICAgICAgIC4gPSB0cnVlICAuIC0gUlxuICAgIG51bWJlcnMgICAuID8gcHJlZml4IHdpdGggbGluZSBudW1iZXJzICAgICAgICAuID0gZmFsc2UgLiAtIE5cbiAgICByZWdleHAgICAgLiA/IHN0cmluZ3MgYXJlIHJlZ2V4cCBwYXR0ZXJucyAgICAgLiA9IGZhbHNlXG4gICAgZG90ICAgICAgIC4gPyBzZWFyY2ggZG90IGZpbGVzICAgICAgICAgICAgICAgIC4gPSBmYWxzZVxuICAgIGFueSAgICAgICAuID8gc2VhcmNoIGFsbCB0ZXh0IGZpbGVzICAgICAgICAgICAuID0gZmFsc2VcbiAgICBkZWJ1ZyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLiA9IGZhbHNlIC4gLSBEXG5cbnZlcnNpb24gICAgICAje3JlcXVpcmUoXCIje19fZGlybmFtZX0vLi4vcGFja2FnZS5qc29uXCIpLnZlcnNpb259XG5cIlwiXCJcblxuaWYgYXJncy5wYXRoID09ICcuJyBhbmQgYXJncy5zdHJpbmdzLmxlbmd0aFxuICAgIGlmIHNsYXNoLmV4aXN0cyBhcmdzLnN0cmluZ3NbMF1cbiAgICAgICAgYXJncy5wYXRoID0gYXJncy5zdHJpbmdzLnNoaWZ0KClcbiAgICBlbHNlIGlmIHNsYXNoLmV4aXN0cyBhcmdzLnN0cmluZ3NbLTFdXG4gICAgICAgIGFyZ3MucGF0aCA9IGFyZ3Muc3RyaW5ncy5wb3AoKVxuICAgICAgICBcbmFyZ3MucGF0aCA9IHNsYXNoLnJlc29sdmUgYXJncy5wYXRoXG5cbiMgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwICBcbiMgMDAwICAwMDAgICAgICAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwICAwMDAgIDAwMDAgIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAgICBcbiMgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICBcblxuaWdub3JlRmlsZSA9IChwKSAtPlxuICAgIFxuICAgIGJhc2UgPSBzbGFzaC5iYXNlbmFtZSBwXG4gICAgZXh0ICA9IHNsYXNoLmV4dCBwXG4gICAgXG4gICAgaWYgc2xhc2gud2luKClcbiAgICAgICAgcmV0dXJuIHRydWUgaWYgYmFzZVswXSA9PSAnJCdcbiAgICAgICAgcmV0dXJuIHRydWUgaWYgYmFzZSA9PSAnZGVza3RvcC5pbmknXG4gICAgICAgIHJldHVybiB0cnVlIGlmIGJhc2UudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoICdudHVzZXInXG4gICAgXG4gICAgcmV0dXJuIGZhbHNlIGlmIHAgPT0gYXJncy5wYXRoXG4gICAgcmV0dXJuIHRydWUgaWYgYmFzZVswXSA9PSAnLicgYW5kIG5vdCBhcmdzLmRvdFxuICAgIHJldHVybiBmYWxzZSBpZiBhcmdzLmFueVxuICAgIHJldHVybiBmYWxzZSBpZiBhcmdzLmpzICAgICBhbmQgZXh0ID09ICdqcydcbiAgICByZXR1cm4gZmFsc2UgaWYgYXJncy5qc29uICAgYW5kIGV4dCA9PSAnanNvbidcbiAgICByZXR1cm4gZmFsc2UgaWYgYXJncy5ub29uICAgYW5kIGV4dCA9PSAnbm9vbidcbiAgICByZXR1cm4gZmFsc2UgaWYgYXJncy5jb2ZmZWUgYW5kIGV4dCBpbiBbJ2tvZmZlZScnY29mZmVlJ11cbiAgICByZXR1cm4gdHJ1ZVxuXG5pZ25vcmVEaXIgPSAocCkgLT5cbiAgICBcbiAgICByZXR1cm4gZmFsc2UgaWYgcCA9PSBhcmdzLnBhdGhcbiAgICBiYXNlID0gc2xhc2guYmFzZW5hbWUgcFxuICAgIGV4dCAgPSBzbGFzaC5leHQgcFxuICAgIHJldHVybiB0cnVlIGlmIGJhc2VbMF0gPT0gJy4nXG4gICAgcmV0dXJuIHRydWUgaWYgYmFzZSA9PSAnbm9kZV9tb2R1bGVzJ1xuICAgIHJldHVybiB0cnVlIGlmIGV4dCAgPT0gJ2FwcCdcbiAgICBmYWxzZVxuICAgICAgICAgICAgICAgIFxuIyAgMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICBcbiMgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4jIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwICAgIDAwMCAgICAgICAwMDAwMDAwMDAgIFxuIyAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICBcbiMgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgXG5cbk5FV0xJTkUgPSAvXFxyP1xcbi9cblxuc2VhcmNoID0gKHBhdGhzKSAtPlxuICAgIFxuICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAgXCIoXCIgKyBhcmdzLnN0cmluZ3MubWFwKChzKSAtPiBrc3RyLmVzY2FwZVJlZ2V4cChzKSkuam9pbignfCcpICsgXCIpXCIsICdnJ1xuXG4gICAgcGF0aHMuZm9yRWFjaCAocGF0aCkgLT5cbiAgICAgICAgXG4gICAgICAgIGlmIHNsYXNoLmlzRGlyIHBhdGhcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZGlyID0gc2xhc2gucmVzb2x2ZSBwYXRoXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIG5vdCBpZ25vcmVEaXIgZGlyXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgc2VhcmNoIGZzLnJlYWRkaXJTeW5jKGRpcikubWFwIChwKSAtPiBzbGFzaC5qb2luIGRpciwgcFxuICAgICAgICAgICAgXG4gICAgICAgIGVsc2UgaWYgc2xhc2guaXNUZXh0IHBhdGhcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZmlsZSA9IHNsYXNoLnJlc29sdmUgcGF0aFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiBub3QgaWdub3JlRmlsZSBmaWxlXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaGVhZGVyID0gZmFsc2VcbiAgICAgICAgICAgICAgICBwcmludEhlYWRlciA9IC0+XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgaWYgYXJncy5oZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbCA9IHNsYXNoLnJlbGF0aXZlIGZpbGUsIHByb2Nlc3MuY3dkKClcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZyAnJ1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nIFcxIGczICcg4pa4ICcgKyBzbGFzaC5kaXJuYW1lKHJlbCkgKyAnLycgKyB5NiBzbGFzaC5iYXNlKHJlbCkgKyB5MiAnLicgKyBzbGFzaC5leHQocmVsKSArICcgJ1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nICcnXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGV4dCAgPSBzbGFzaC5yZWFkVGV4dCBmaWxlXG4gICAgICAgICAgICAgICAgbGluZXMgPSB0ZXh0LnNwbGl0IE5FV0xJTkVcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBybmdzID0ga2xvci5kaXNzZWN0IGxpbmVzLCAnY29mZmVlJ1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGZvciBpbmRleCBpbiBbMC4uLmxpbmVzLmxlbmd0aF1cbiAgICAgICAgICAgICAgICAgICAgbGluZSA9IGxpbmVzW2luZGV4XVxuICAgICAgICAgICAgICAgICAgICBpZiBsaW5lLnNlYXJjaChyZWdleHApID49IDBcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50SGVhZGVyKCkgaWYgbm90IGhlYWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0IHJuZ3NbaW5kZXhdLCBpbmRleCsxXG5cbiMgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgXG4jICAwMDAwMDAwICAgIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMCAgICAgICAgIDAwMDAwMDAgICAgICAwMDAgICAgIFxuXG5vdXRwdXQgPSAocm5ncywgbnVtYmVyKSAtPlxuICAgIFxuICAgIGMgPSAwXG4gICAgY2xyemQgPSAnJ1xuICAgIGlmIGFyZ3MubnVtYmVyc1xuICAgICAgICBjbHJ6ZCArPSB3MihcIiN7bnVtYmVyfVwiKSArIHcxICc6J1xuICAgIGZvciBpIGluIFswLi4ucm5ncy5sZW5ndGhdXG4gICAgICAgIHdoaWxlIGMgPCBybmdzW2ldLnN0YXJ0IFxuICAgICAgICAgICAgYysrXG4gICAgICAgICAgICBjbHJ6ZCArPSAnICdcbiAgICAgICAgY2xyemQgKz0gY29sb3JpemUgcm5nc1tpXVxuICAgICAgICBjICs9IHJuZ3NbaV0ubWF0Y2gubGVuZ3RoXG4gICAgbG9nIGNscnpkXG5cbiMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgICAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMCAgMDAwMDAwMCAgMDAwMDAwMDAgIFxuIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAwMDAgICAwMDAgICAgICAgXG4jIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAgICAgMDAwICAgIDAwMDAwMDAgICBcbiMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAgIFxuIyAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgXG5cbmNvbG9yaXplID0gKGNodW5rKSAtPiBcblxuICAgIGlmIGNuID0ga29sb3IubWFwW2NodW5rLnZhbHVlXVxuICAgICAgICBpZiBjbiBpbnN0YW5jZW9mIEFycmF5XG4gICAgICAgICAgICB2ID0gY2h1bmsubWF0Y2hcbiAgICAgICAgICAgIGZvciBjIGluIGNuXG4gICAgICAgICAgICAgICAgdiA9IGtvbG9yW2NdIHZcbiAgICAgICAgICAgIHJldHVybiB2XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiBrb2xvcltjbl0gY2h1bmsubWF0Y2hcbiAgICBjaHVuay5tYXRjaFxuICAgIFxuIyAwMCAgICAgMDAgICAwMDAwMDAwICAgMDAwICAwMDAgICAwMDBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwXG4jIDAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgIDAwMCAwIDAwMFxuIyAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAgIDAwMDBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwXG5cbmtsb2cgJ2FyZ3M6JyBhcmdzIGlmIGFyZ3MuZGVidWdcblxuc2VhcmNoIFthcmdzLnBhdGhdXG4iXX0=
//# sourceURL=../coffee/krep.coffee
// koffee 0.45.0

/*
000   000  00000000   00000000  00000000 
000  000   000   000  000       000   000
0000000    0000000    0000000   00000000 
000  000   000   000  000       000      
000   000  000   000  00000000  000
 */
var NEWLINE, _, args, colorize, fs, ignoreDir, ignoreFile, karg, klog, klor, kolor, kstr, output, ref, search, slash, valid;

ref = require('kxk'), slash = ref.slash, karg = ref.karg, klog = ref.klog, kstr = ref.kstr, valid = ref.valid, fs = ref.fs, _ = ref._;

kolor = require('./kolor');

klor = require('klor');

kolor.globalize();

args = karg("krep\n    strings   . ? text to search for                . **\n    path      . ? file or folder to search in       . = |.|\n    ext       . ? search only files with extension  . = ||\n    coffee    . ? search coffeescript files         . = true\n    noon      . ? search noon files                 . = true\n    js        . ? search javascript files           . = true\n    json      . ? search json files                 . = true  . - J\n    header    . ? print file headers                . = true  . - H\n    recurse   . ? recurse into subdirs              . = true  . - R\n    numbers   . ? prefix with line numbers          . = false . - N\n    regexp    . ? strings are regexp patterns       . = false\n    dot       . ? search dot files                  . = false\n    any       . ? search all text files             . = false\n    debug                                           . = false . - D\n\nversion      " + (require(__dirname + "/../package.json").version));

if (args.path === '.' && args.strings.length) {
    if (slash.exists(args.strings[0])) {
        args.path = args.strings.shift();
    } else if (slash.exists(args.strings.slice(-1)[0])) {
        args.path = args.strings.pop();
    }
}

args.path = slash.resolve(args.path);

if (valid(args.__ignored)) {
    args.strings = args.strings.concat(args.__ignored);
}

ignoreFile = function(p) {
    var base, ext;
    base = slash.basename(p);
    ext = slash.ext(p);
    if (slash.win()) {
        if (base[0] === '$') {
            return true;
        }
        if (base === 'desktop.ini') {
            return true;
        }
        if (base.toLowerCase().startsWith('ntuser')) {
            return true;
        }
    }
    if (p === args.path) {
        return false;
    }
    if (args.ext) {
        return ext !== args.ext;
    }
    if (base[0] === '.' && !args.dot) {
        return true;
    }
    if (args.any) {
        return false;
    }
    if (args.js && ext === 'js') {
        return false;
    }
    if (args.json && ext === 'json') {
        return false;
    }
    if (args.noon && ext === 'noon') {
        return false;
    }
    if (args.coffee && (ext === 'koffee' || ext === 'coffee')) {
        return false;
    }
    return true;
};

ignoreDir = function(p) {
    var base, ext;
    if (p === args.path) {
        return false;
    }
    base = slash.basename(p);
    ext = slash.ext(p);
    if (base[0] === '.') {
        return true;
    }
    if (base === 'node_modules') {
        return true;
    }
    if (ext === 'app') {
        return true;
    }
    return false;
};

NEWLINE = /\r?\n/;

search = function(paths) {
    var regexp;
    if (args.regexp) {
        regexp = new RegExp("(" + args.strings.join('|') + ")", 'g');
    } else {
        regexp = new RegExp("(" + args.strings.map(function(s) {
            return kstr.escapeRegexp(s);
        }).join('|') + ")", 'g');
    }
    return paths.forEach(function(path) {
        var dir, file, header, index, j, line, lines, printHeader, ref1, results, rngs, text;
        if (slash.isDir(path)) {
            dir = slash.resolve(path);
            if (!ignoreDir(dir)) {
                return search(fs.readdirSync(dir).map(function(p) {
                    return slash.join(dir, p);
                }));
            }
        } else if (slash.isText(path)) {
            file = slash.resolve(path);
            if (!ignoreFile(file)) {
                header = false;
                printHeader = function() {
                    var rel;
                    header = true;
                    if (args.header) {
                        rel = slash.relative(file, process.cwd());
                        console.log('');
                        console.log(W1(g3(' â–¸ ' + slash.dirname(rel) + '/' + y6(slash.base(rel) + y2('.' + slash.ext(rel) + ' ')))));
                        return console.log('');
                    }
                };
                text = slash.readText(file);
                lines = text.split(NEWLINE);
                rngs = klor.dissect(lines, 'coffee');
                results = [];
                for (index = j = 0, ref1 = lines.length; 0 <= ref1 ? j < ref1 : j > ref1; index = 0 <= ref1 ? ++j : --j) {
                    line = lines[index];
                    if (line.search(regexp) >= 0) {
                        if (!header) {
                            printHeader();
                        }
                        results.push(output(rngs[index], index + 1));
                    } else {
                        results.push(void 0);
                    }
                }
                return results;
            }
        }
    });
};

output = function(rngs, number) {
    var c, clrzd, i, j, numstr, ref1;
    c = 0;
    clrzd = '';
    if (args.numbers) {
        numstr = String(number);
        clrzd += w1(numstr) + _.pad('', 4 - numstr.length);
    }
    for (i = j = 0, ref1 = rngs.length; 0 <= ref1 ? j < ref1 : j > ref1; i = 0 <= ref1 ? ++j : --j) {
        while (c < rngs[i].start) {
            c++;
            clrzd += ' ';
        }
        clrzd += colorize(rngs[i]);
        c += rngs[i].match.length;
    }
    return console.log(clrzd);
};

colorize = function(chunk) {
    var c, cn, j, len, v;
    if (cn = kolor.map[chunk.value]) {
        if (cn instanceof Array) {
            v = chunk.match;
            for (j = 0, len = cn.length; j < len; j++) {
                c = cn[j];
                v = kolor[c](v);
            }
            return v;
        } else {
            return kolor[cn](chunk.match);
        }
    }
    return chunk.match;
};

if (args.debug) {
    klog('args:', args);
}

search([args.path]);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia3JlcC5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUE7O0FBUUEsTUFBNEMsT0FBQSxDQUFRLEtBQVIsQ0FBNUMsRUFBRSxpQkFBRixFQUFTLGVBQVQsRUFBZSxlQUFmLEVBQXFCLGVBQXJCLEVBQTJCLGlCQUEzQixFQUFrQyxXQUFsQyxFQUFzQzs7QUFFdEMsS0FBQSxHQUFRLE9BQUEsQ0FBUSxTQUFSOztBQUNSLElBQUEsR0FBUSxPQUFBLENBQVEsTUFBUjs7QUFFUixLQUFLLENBQUMsU0FBTixDQUFBOztBQVFBLElBQUEsR0FBTyxJQUFBLENBQUssMDVCQUFBLEdBaUJFLENBQUMsT0FBQSxDQUFXLFNBQUQsR0FBVyxrQkFBckIsQ0FBdUMsQ0FBQyxPQUF6QyxDQWpCUDs7QUFvQlAsSUFBRyxJQUFJLENBQUMsSUFBTCxLQUFhLEdBQWIsSUFBcUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFyQztJQUNJLElBQUcsS0FBSyxDQUFDLE1BQU4sQ0FBYSxJQUFJLENBQUMsT0FBUSxDQUFBLENBQUEsQ0FBMUIsQ0FBSDtRQUNJLElBQUksQ0FBQyxJQUFMLEdBQVksSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFiLENBQUEsRUFEaEI7S0FBQSxNQUVLLElBQUcsS0FBSyxDQUFDLE1BQU4sQ0FBYSxJQUFJLENBQUMsT0FBUSxVQUFFLENBQUEsQ0FBQSxDQUE1QixDQUFIO1FBQ0QsSUFBSSxDQUFDLElBQUwsR0FBWSxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQWIsQ0FBQSxFQURYO0tBSFQ7OztBQU1BLElBQUksQ0FBQyxJQUFMLEdBQVksS0FBSyxDQUFDLE9BQU4sQ0FBYyxJQUFJLENBQUMsSUFBbkI7O0FBRVosSUFBRyxLQUFBLENBQU0sSUFBSSxDQUFDLFNBQVgsQ0FBSDtJQUNJLElBQUksQ0FBQyxPQUFMLEdBQWUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFiLENBQW9CLElBQUks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QUVBLG1CQUFPLEVBSlg7U0FBQSxNQUFBO0FBTUksbUJBQU8sS0FBTSxDQUFBLEVBQUEsQ0FBTixDQUFVLEtBQUssQ0FBQyxLQUFoQixFQU5YO1NBREo7O1dBUUEsS0FBSyxDQUFDO0FBVkM7O0FBa0JYLElBQXFCLElBQUksQ0FBQyxLQUExQjtJQUFBLElBQUEsQ0FBSyxPQUFMLEVBQWEsSUFBYixFQUFBOzs7QUFFQSxNQUFBLENBQU8sQ0FBQyxJQUFJLENBQUMsSUFBTixDQUFQIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMDAgIDAwMDAwMDAwIFxuMDAwICAwMDAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDBcbjAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMDAgXG4wMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIFxuMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAgICBcbiMjI1xuXG57IHNsYXNoLCBrYXJnLCBrbG9nLCBrc3RyLCB2YWxpZCwgZnMsIF8gfSA9IHJlcXVpcmUgJ2t4aydcblxua29sb3IgPSByZXF1aXJlICcuL2tvbG9yJ1xua2xvciAgPSByZXF1aXJlICdrbG9yJ1xuXG5rb2xvci5nbG9iYWxpemUoKVxuXG4jICAwMDAwMDAwICAgMDAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMFxuIyAwMDAwMDAwMDAgIDAwMDAwMDAgICAgMDAwICAwMDAwICAwMDAwMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgICAgMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDBcblxuYXJncyA9IGthcmcgXCJcIlwiXG5rcmVwXG4gICAgc3RyaW5ncyAgIC4gPyB0ZXh0IHRvIHNlYXJjaCBmb3IgICAgICAgICAgICAgICAgLiAqKlxuICAgIHBhdGggICAgICAuID8gZmlsZSBvciBmb2xkZXIgdG8gc2VhcmNoIGluICAgICAgIC4gPSB8LnxcbiAgICBleHQgICAgICAgLiA/IHNlYXJjaCBvbmx5IGZpbGVzIHdpdGggZXh0ZW5zaW9uICAuID0gfHxcbiAgICBjb2ZmZWUgICAgLiA/IHNlYXJjaCBjb2ZmZWVzY3JpcHQgZmlsZXMgICAgICAgICAuID0gdHJ1ZVxuICAgIG5vb24gICAgICAuID8gc2VhcmNoIG5vb24gZmlsZXMgICAgICAgICAgICAgICAgIC4gPSB0cnVlXG4gICAganMgICAgICAgIC4gPyBzZWFyY2ggamF2YXNjcmlwdCBmaWxlcyAgICAgICAgICAgLiA9IHRydWVcbiAgICBqc29uICAgICAgLiA/IHNlYXJjaCBqc29uIGZpbGVzICAgICAgICAgICAgICAgICAuID0gdHJ1ZSAgLiAtIEpcbiAgICBoZWFkZXIgICAgLiA/IHByaW50IGZpbGUgaGVhZGVycyAgICAgICAgICAgICAgICAuID0gdHJ1ZSAgLiAtIEhcbiAgICByZWN1cnNlICAgLiA/IHJlY3Vyc2UgaW50byBzdWJkaXJzICAgICAgICAgICAgICAuID0gdHJ1ZSAgLiAtIFJcbiAgICBudW1iZXJzICAgLiA/IHByZWZpeCB3aXRoIGxpbmUgbnVtYmVycyAgICAgICAgICAuID0gZmFsc2UgLiAtIE5cbiAgICByZWdleHAgICAgLiA/IHN0cmluZ3MgYXJlIHJlZ2V4cCBwYXR0ZXJucyAgICAgICAuID0gZmFsc2VcbiAgICBkb3QgICAgICAgLiA/IHNlYXJjaCBkb3QgZmlsZXMgICAgICAgICAgICAgICAgICAuID0gZmFsc2VcbiAgICBhbnkgICAgICAgLiA/IHNlYXJjaCBhbGwgdGV4dCBmaWxlcyAgICAgICAgICAgICAuID0gZmFsc2VcbiAgICBkZWJ1ZyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuID0gZmFsc2UgLiAtIERcblxudmVyc2lvbiAgICAgICN7cmVxdWlyZShcIiN7X19kaXJuYW1lfS8uLi9wYWNrYWdlLmpzb25cIikudmVyc2lvbn1cblwiXCJcIlxuXG5pZiBhcmdzLnBhdGggPT0gJy4nIGFuZCBhcmdzLnN0cmluZ3MubGVuZ3RoXG4gICAgaWYgc2xhc2guZXhpc3RzIGFyZ3Muc3RyaW5nc1swXVxuICAgICAgICBhcmdzLnBhdGggPSBhcmdzLnN0cmluZ3Muc2hpZnQoKVxuICAgIGVsc2UgaWYgc2xhc2guZXhpc3RzIGFyZ3Muc3RyaW5nc1stMV1cbiAgICAgICAgYXJncy5wYXRoID0gYXJncy5zdHJpbmdzLnBvcCgpXG4gICAgICAgIFxuYXJncy5wYXRoID0gc2xhc2gucmVzb2x2ZSBhcmdzLnBhdGhcblxuaWYgdmFsaWQgYXJncy5fX2lnbm9yZWRcbiAgICBhcmdzLnN0cmluZ3MgPSBhcmdzLnN0cmluZ3MuY29uY2F0IGFyZ3MuX19pZ25vcmVkXG5cbiMgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwICBcbiMgMDAwICAwMDAgICAgICAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwICAwMDAgIDAwMDAgIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAgICBcbiMgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICBcblxuaWdub3JlRmlsZSA9IChwKSAtPlxuICAgIFxuICAgIGJhc2UgPSBzbGFzaC5iYXNlbmFtZSBwXG4gICAgZXh0ICA9IHNsYXNoLmV4dCBwXG4gICAgXG4gICAgaWYgc2xhc2gud2luKClcbiAgICAgICAgcmV0dXJuIHRydWUgaWYgYmFzZVswXSA9PSAnJCdcbiAgICAgICAgcmV0dXJuIHRydWUgaWYgYmFzZSA9PSAnZGVza3RvcC5pbmknXG4gICAgICAgIHJldHVybiB0cnVlIGlmIGJhc2UudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoICdudHVzZXInXG4gICAgXG4gICAgcmV0dXJuIGZhbHNlIGlmIHAgPT0gYXJncy5wYXRoXG4gICAgaWYgYXJncy5leHQgdGhlbiByZXR1cm4gZXh0ICE9IGFyZ3MuZXh0XG4gICAgcmV0dXJuIHRydWUgaWYgYmFzZVswXSA9PSAnLicgYW5kIG5vdCBhcmdzLmRvdFxuICAgIHJldHVybiBmYWxzZSBpZiBhcmdzLmFueVxuICAgIHJldHVybiBmYWxzZSBpZiBhcmdzLmpzICAgICBhbmQgZXh0ID09ICdqcydcbiAgICByZXR1cm4gZmFsc2UgaWYgYXJncy5qc29uICAgYW5kIGV4dCA9PSAnanNvbidcbiAgICByZXR1cm4gZmFsc2UgaWYgYXJncy5ub29uICAgYW5kIGV4dCA9PSAnbm9vbidcbiAgICByZXR1cm4gZmFsc2UgaWYgYXJncy5jb2ZmZWUgYW5kIGV4dCBpbiBbJ2tvZmZlZScnY29mZmVlJ11cbiAgICByZXR1cm4gdHJ1ZVxuXG5pZ25vcmVEaXIgPSAocCkgLT5cbiAgICBcbiAgICByZXR1cm4gZmFsc2UgaWYgcCA9PSBhcmdzLnBhdGhcbiAgICBiYXNlID0gc2xhc2guYmFzZW5hbWUgcFxuICAgIGV4dCAgPSBzbGFzaC5leHQgcFxuICAgIHJldHVybiB0cnVlIGlmIGJhc2VbMF0gPT0gJy4nXG4gICAgcmV0dXJuIHRydWUgaWYgYmFzZSA9PSAnbm9kZV9tb2R1bGVzJ1xuICAgIHJldHVybiB0cnVlIGlmIGV4dCAgPT0gJ2FwcCdcbiAgICBmYWxzZVxuICAgICAgICAgICAgICAgIFxuIyAgMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICBcbiMgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4jIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwICAgIDAwMCAgICAgICAwMDAwMDAwMDAgIFxuIyAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICBcbiMgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgXG5cbk5FV0xJTkUgPSAvXFxyP1xcbi9cblxuc2VhcmNoID0gKHBhdGhzKSAtPlxuICAgIFxuICAgIGlmIGFyZ3MucmVnZXhwXG4gICAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAgXCIoXCIgKyBhcmdzLnN0cmluZ3Muam9pbignfCcpICsgXCIpXCIsICdnJ1xuICAgIGVsc2VcbiAgICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cCBcIihcIiArIGFyZ3Muc3RyaW5ncy5tYXAoKHMpIC0+IGtzdHIuZXNjYXBlUmVnZXhwKHMpKS5qb2luKCd8JykgKyBcIilcIiwgJ2cnXG5cbiAgICBwYXRocy5mb3JFYWNoIChwYXRoKSAtPlxuICAgICAgICBcbiAgICAgICAgaWYgc2xhc2guaXNEaXIgcGF0aFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBkaXIgPSBzbGFzaC5yZXNvbHZlIHBhdGhcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgbm90IGlnbm9yZURpciBkaXJcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBzZWFyY2ggZnMucmVhZGRpclN5bmMoZGlyKS5tYXAgKHApIC0+IHNsYXNoLmpvaW4gZGlyLCBwXG4gICAgICAgICAgICBcbiAgICAgICAgZWxzZSBpZiBzbGFzaC5pc1RleHQgcGF0aFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBmaWxlID0gc2xhc2gucmVzb2x2ZSBwYXRoXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIG5vdCBpZ25vcmVGaWxlIGZpbGVcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBoZWFkZXIgPSBmYWxzZVxuICAgICAgICAgICAgICAgIHByaW50SGVhZGVyID0gLT5cbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyID0gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICBpZiBhcmdzLmhlYWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVsID0gc2xhc2gucmVsYXRpdmUgZmlsZSwgcHJvY2Vzcy5jd2QoKVxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nICcnXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2cgVzEgZzMgJyDilrggJyArIHNsYXNoLmRpcm5hbWUocmVsKSArICcvJyArIHk2IHNsYXNoLmJhc2UocmVsKSArIHkyICcuJyArIHNsYXNoLmV4dChyZWwpICsgJyAnXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2cgJydcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0ZXh0ICA9IHNsYXNoLnJlYWRUZXh0IGZpbGVcbiAgICAgICAgICAgICAgICBsaW5lcyA9IHRleHQuc3BsaXQgTkVXTElORVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJuZ3MgPSBrbG9yLmRpc3NlY3QgbGluZXMsICdjb2ZmZWUnXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgZm9yIGluZGV4IGluIFswLi4ubGluZXMubGVuZ3RoXVxuICAgICAgICAgICAgICAgICAgICBsaW5lID0gbGluZXNbaW5kZXhdXG4gICAgICAgICAgICAgICAgICAgIGlmIGxpbmUuc2VhcmNoKHJlZ2V4cCkgPj0gMFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRIZWFkZXIoKSBpZiBub3QgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgcm5nc1tpbmRleF0sIGluZGV4KzFcblxuIyAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMDAwMDAwICAgMDAwICAgMDAwICAgICAwMDAgICAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiMgIDAwMDAwMDAgICAgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwICAgICAgICAgMDAwMDAwMCAgICAgIDAwMCAgICAgXG5cbm91dHB1dCA9IChybmdzLCBudW1iZXIpIC0+XG4gICAgXG4gICAgYyA9IDBcbiAgICBjbHJ6ZCA9ICcnXG4gICAgaWYgYXJncy5udW1iZXJzXG4gICAgICAgIG51bXN0ciA9IFN0cmluZyBudW1iZXJcbiAgICAgICAgY2xyemQgKz0gdzEobnVtc3RyKSArIF8ucGFkICcnLCA0LW51bXN0ci5sZW5ndGhcbiAgICBmb3IgaSBpbiBbMC4uLnJuZ3MubGVuZ3RoXVxuICAgICAgICB3aGlsZSBjIDwgcm5nc1tpXS5zdGFydCBcbiAgICAgICAgICAgIGMrK1xuICAgICAgICAgICAgY2xyemQgKz0gJyAnXG4gICAgICAgIGNscnpkICs9IGNvbG9yaXplIHJuZ3NbaV1cbiAgICAgICAgYyArPSBybmdzW2ldLm1hdGNoLmxlbmd0aFxuICAgIGxvZyBjbHJ6ZFxuXG4jICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgICAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICBcbiMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgMDAwICAgMDAwICAgICAgIFxuIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwICAgIDAwMCAgICAwMDAwMDAwICAgXG4jIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgICBcbiMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMCAgMDAwMDAwMCAgMDAwMDAwMDAgIFxuXG5jb2xvcml6ZSA9IChjaHVuaykgLT4gXG5cbiAgICBpZiBjbiA9IGtvbG9yLm1hcFtjaHVuay52YWx1ZV1cbiAgICAgICAgaWYgY24gaW5zdGFuY2VvZiBBcnJheVxuICAgICAgICAgICAgdiA9IGNodW5rLm1hdGNoXG4gICAgICAgICAgICBmb3IgYyBpbiBjblxuICAgICAgICAgICAgICAgIHYgPSBrb2xvcltjXSB2XG4gICAgICAgICAgICByZXR1cm4gdlxuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4ga29sb3JbY25dIGNodW5rLm1hdGNoXG4gICAgY2h1bmsubWF0Y2hcbiAgICBcbiMgMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMCAgMDAwICAgMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMFxuIyAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwICAwMDAgMCAwMDBcbiMgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwICAwMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMFxuXG5rbG9nICdhcmdzOicgYXJncyBpZiBhcmdzLmRlYnVnXG5cbnNlYXJjaCBbYXJncy5wYXRoXVxuIl19
//# sourceURL=../coffee/krep.coffee
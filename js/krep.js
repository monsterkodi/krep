// koffee 0.45.0

/*
000   000  00000000   00000000  00000000 
000  000   000   000  000       000   000
0000000    0000000    0000000   00000000 
000  000   000   000  000       000      
000   000  000   000  00000000  000
 */
var NEWLINE, _, args, childp, colorize, colormap, fs, ignoreDir, ignoreFile, karg, klog, klor, kolor, kstr, output, ref, search, slash;

ref = require('kxk'), childp = ref.childp, slash = ref.slash, karg = ref.karg, klog = ref.klog, kstr = ref.kstr, fs = ref.fs, _ = ref._;

kolor = require('./kolor');

klor = require('klor');

args = karg("krep\n    strings       . ? text to search for              . **\n    path          . ? file or folder to search in     . = |.|\n    coffee        . ? search coffeescript files       . = true\n    noon          . ? search noon files               . = true\n    js            . ? search javascript files         . = true\n    json          . ? search json files               . = true  . - J\n    recurse       . ? recurse into subdirs            . = true  . - R\n    regexp        . ? strings are regexp patterns     . = false\n    dot           . ? search dot files                . = false\n    any           . ? search all text files           . = false\n    debug                                             . = false . - D\n\nversion      " + (require(__dirname + "/../package.json").version));

if (args.strings.length > 1 && args.path === '.') {
    if (slash.exists(args.strings[0])) {
        args.path = args.strings.shift();
    } else if (slash.exists(args.strings.slice(-1)[0])) {
        args.path = args.strings.pop();
    }
}

ignoreFile = function(p) {
    var base, ext;
    base = slash.basename(p);
    if (slash.win()) {
        if (base[0] === '$') {
            return true;
        }
        if (base === 'desktop.ini') {
            return true;
        }
        if (base.toLowerCase().startsWith('ntuser')) {
            return true;
        }
    }
    if (!args.all) {
        if (base[0] === '.') {
            return true;
        }
        if (args.any) {
            return false;
        }
        ext = slash.ext(p);
        if (!args.js && ext === 'js') {
            return true;
        }
        if (!args.json && ext === 'json') {
            return true;
        }
        if (!args.noon && ext === 'noon') {
            return true;
        }
        if (!args.coffee && (ext === 'koffee' || ext === 'coffee')) {
            return true;
        }
    }
    return false;
};

ignoreDir = function(p) {
    var base;
    if (!args.all) {
        base = slash.basename(p);
        if (base[0] === '.') {
            return true;
        }
        if (base === 'node_modules') {
            return true;
        }
    }
    return false;
};

colormap = {
    'punct': 'w3',
    'punct this': 'b3',
    'punct comment': 'w1',
    'punct comment triple': 'w1',
    'punct regexp start': 'm8',
    'punct regexp end': 'm8',
    'punct regexp': 'm2',
    'punct regexp triple': 'm2',
    'punct semver': 'r2',
    'punct escape regexp': 'm1',
    'punct escape regexp triple': 'm1',
    'punct string single': 'g1',
    'punct string single triple': 'g1',
    'punct string double': 'g2',
    'punct string double triple': 'g2',
    'punct string interpolation start': 'g1',
    'punct string interpolation end': 'g1',
    'punct dictionary': 'y8',
    'punct property': 'y1',
    'punct range': 'b4',
    'punct method': 'r2',
    'punct function': 'r1',
    'punct function tail': ['b6', 'bold', 'B1'],
    'punct function head': ['b6', 'bold', 'B1'],
    'punct function bound tail': ['r5', 'bold', 'R1'],
    'punct function bound head': ['r5', 'bold', 'R1'],
    'punct h1': 'y1',
    'text h1': 'y4',
    'punct h2': 'r1',
    'text h2': 'r4',
    'punct h3': 'b3',
    'text h3': 'b8',
    'punct h4': 'b2',
    'text h4': 'b6',
    'punct h5': 'b1',
    'text h5': 'b5',
    'string single': 'g3',
    'string single triple': 'g3',
    'string double': 'g4',
    'string double triple': 'g4',
    'nil': 'm2',
    'obj': 'y5',
    'text': 'w8',
    'text this': 'b8',
    'text regexp': 'm6',
    'text regexp triple': 'm6',
    'require': 'w3',
    'keyword': 'b8',
    'number': 'b7',
    'number hex': 'c3',
    'number float': 'r7',
    'punct number float': 'r3',
    'semver': 'r5',
    'module this': 'y2',
    'module': 'y6',
    'class': 'y5',
    'property': 'y6',
    'dictionary key': 'y8',
    'punct function call': 'r2',
    'function call this': 'r2',
    'function call': 'r5',
    'function': 'r4',
    'method': 'r6',
    'punct bold': 'b1',
    'text bold': 'b7',
    'text code': 'b8',
    'punct code': 'b1',
    'punct code triple': 'b1',
    'punct meta': 'g1',
    'meta': 'g4',
    'comment': 'w3',
    'comment triple': 'w4',
    'comment header': ['g1', 'G1'],
    'comment triple header': ['g2', 'G2']
};

colorize = function(chunk) {
    var c, cn, j, len, v;
    if (cn = colormap[chunk.value]) {
        if (cn instanceof Array) {
            v = chunk.match;
            for (j = 0, len = cn.length; j < len; j++) {
                c = cn[j];
                v = kolor[c](v);
            }
            return v;
        } else {
            return kolor[cn](chunk.match);
        }
    }
    return chunk.match;
};

output = function(rngs) {
    var c, clrzd, i, j, ref1;
    c = 0;
    clrzd = '';
    for (i = j = 0, ref1 = rngs.length; 0 <= ref1 ? j < ref1 : j > ref1; i = 0 <= ref1 ? ++j : --j) {
        while (c < rngs[i].start) {
            c++;
            clrzd += ' ';
        }
        clrzd += colorize(rngs[i]);
        c += rngs[i].match.length;
    }
    return console.log(clrzd);
};

NEWLINE = /\r?\n/;

search = function(paths) {
    var regexp;
    regexp = new RegExp("(" + args.strings.map(function(s) {
        return kstr.escapeRegexp(s);
    }).join('|') + ")", 'g');
    return paths.forEach(function(path) {
        var dir, file, index, j, line, lines, ref1, results, rngs, text;
        if (slash.isDir(path)) {
            dir = slash.resolve(path);
            if (!ignoreDir(dir)) {
                return search(fs.readdirSync(dir).map(function(p) {
                    return slash.join(dir, p);
                }));
            }
        } else if (slash.isText(path)) {
            file = slash.resolve(path);
            if (!ignoreFile(file)) {
                text = slash.readText(file);
                lines = text.split(NEWLINE);
                rngs = klor.dissect(lines, 'coffee');
                results = [];
                for (index = j = 0, ref1 = lines.length; 0 <= ref1 ? j < ref1 : j > ref1; index = 0 <= ref1 ? ++j : --j) {
                    line = lines[index];
                    if (line.search(regexp) >= 0) {
                        results.push(output(rngs[index]));
                    } else {
                        results.push(void 0);
                    }
                }
                return results;
            }
        }
    });
};

if (args.debug) {
    klog('args:', args);
}

search([args.path]);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia3JlcC5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUE7O0FBUUEsTUFBNkMsT0FBQSxDQUFRLEtBQVIsQ0FBN0MsRUFBRSxtQkFBRixFQUFVLGlCQUFWLEVBQWlCLGVBQWpCLEVBQXVCLGVBQXZCLEVBQTZCLGVBQTdCLEVBQW1DLFdBQW5DLEVBQXVDOztBQUV2QyxLQUFBLEdBQVEsT0FBQSxDQUFRLFNBQVI7O0FBQ1IsSUFBQSxHQUFRLE9BQUEsQ0FBUSxNQUFSOztBQVFSLElBQUEsR0FBTyxJQUFBLENBQUssMHVCQUFBLEdBY0UsQ0FBQyxPQUFBLENBQVcsU0FBRCxHQUFXLGtCQUFyQixDQUF1QyxDQUFDLE9BQXpDLENBZFA7O0FBaUJQLElBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFiLEdBQXNCLENBQXRCLElBQTRCLElBQUksQ0FBQyxJQUFMLEtBQWEsR0FBNUM7SUFDSSxJQUFHLEtBQUssQ0FBQyxNQUFOLENBQWEsSUFBSSxDQUFDLE9BQVEsQ0FBQSxDQUFBLENBQTFCLENBQUg7UUFDSSxJQUFJLENBQUMsSUFBTCxHQUFZLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBYixDQUFBLEVBRGhCO0tBQUEsTUFFSyxJQUFHLEtBQUssQ0FBQyxNQUFOLENBQWEsSUFBSSxDQUFDLE9BQVEsVUFBRSxDQUFBLENBQUEsQ0FBNUIsQ0FBSDtRQUNELElBQUksQ0FBQyxJQUFMLEdBQVksSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFiLENBQUEsRUFEWDtLQUhUOzs7QUFZQSxVQUFBLEdBQWEsU0FBQyxDQUFEO0FBRVQsUUFBQTtJQUFBLElBQUEsR0FBTyxLQUFLLENBQUMsUUFBTixDQUFlLENBQWY7SUFFUCxJQUFHLEtBQUssQ0FBQyxHQUFOLENBQUEsQ0FBSDtRQUNJLElBQWUsSUFBSyxDQUFBLENBQUEsQ0FBTCxLQUFXLEdBQTFCO0FBQUEsbUJBQU8sS0FBUDs7UUFDQSxJQUFl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c291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMDAgIDAwMDAwMDAwIFxuMDAwICAwMDAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDBcbjAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMDAgXG4wMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIFxuMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAgICBcbiMjI1xuXG57IGNoaWxkcCwgc2xhc2gsIGthcmcsIGtsb2csIGtzdHIsIGZzLCBfIH0gPSByZXF1aXJlICdreGsnXG5cbmtvbG9yID0gcmVxdWlyZSAnLi9rb2xvcidcbmtsb3IgID0gcmVxdWlyZSAna2xvcidcblxuIyAgMDAwMDAwMCAgIDAwMDAwMDAwICAgIDAwMDAwMDAgICAgMDAwMDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDBcbiMgMDAwMDAwMDAwICAwMDAwMDAwICAgIDAwMCAgMDAwMCAgMDAwMDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgIDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwXG5cbmFyZ3MgPSBrYXJnIFwiXCJcIlxua3JlcFxuICAgIHN0cmluZ3MgICAgICAgLiA/IHRleHQgdG8gc2VhcmNoIGZvciAgICAgICAgICAgICAgLiAqKlxuICAgIHBhdGggICAgICAgICAgLiA/IGZpbGUgb3IgZm9sZGVyIHRvIHNlYXJjaCBpbiAgICAgLiA9IHwufFxuICAgIGNvZmZlZSAgICAgICAgLiA/IHNlYXJjaCBjb2ZmZWVzY3JpcHQgZmlsZXMgICAgICAgLiA9IHRydWVcbiAgICBub29uICAgICAgICAgIC4gPyBzZWFyY2ggbm9vbiBmaWxlcyAgICAgICAgICAgICAgIC4gPSB0cnVlXG4gICAganMgICAgICAgICAgICAuID8gc2VhcmNoIGphdmFzY3JpcHQgZmlsZXMgICAgICAgICAuID0gdHJ1ZVxuICAgIGpzb24gICAgICAgICAgLiA/IHNlYXJjaCBqc29uIGZpbGVzICAgICAgICAgICAgICAgLiA9IHRydWUgIC4gLSBKXG4gICAgcmVjdXJzZSAgICAgICAuID8gcmVjdXJzZSBpbnRvIHN1YmRpcnMgICAgICAgICAgICAuID0gdHJ1ZSAgLiAtIFJcbiAgICByZWdleHAgICAgICAgIC4gPyBzdHJpbmdzIGFyZSByZWdleHAgcGF0dGVybnMgICAgIC4gPSBmYWxzZVxuICAgIGRvdCAgICAgICAgICAgLiA/IHNlYXJjaCBkb3QgZmlsZXMgICAgICAgICAgICAgICAgLiA9IGZhbHNlXG4gICAgYW55ICAgICAgICAgICAuID8gc2VhcmNoIGFsbCB0ZXh0IGZpbGVzICAgICAgICAgICAuID0gZmFsc2VcbiAgICBkZWJ1ZyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4gPSBmYWxzZSAuIC0gRFxuXG52ZXJzaW9uICAgICAgI3tyZXF1aXJlKFwiI3tfX2Rpcm5hbWV9Ly4uL3BhY2thZ2UuanNvblwiKS52ZXJzaW9ufVxuXCJcIlwiXG5cbmlmIGFyZ3Muc3RyaW5ncy5sZW5ndGggPiAxIGFuZCBhcmdzLnBhdGggPT0gJy4nXG4gICAgaWYgc2xhc2guZXhpc3RzIGFyZ3Muc3RyaW5nc1swXVxuICAgICAgICBhcmdzLnBhdGggPSBhcmdzLnN0cmluZ3Muc2hpZnQoKVxuICAgIGVsc2UgaWYgc2xhc2guZXhpc3RzIGFyZ3Muc3RyaW5nc1stMV1cbiAgICAgICAgYXJncy5wYXRoID0gYXJncy5zdHJpbmdzLnBvcCgpXG5cbiMgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwICBcbiMgMDAwICAwMDAgICAgICAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwICAwMDAgIDAwMDAgIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAgICBcbiMgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICBcblxuaWdub3JlRmlsZSA9IChwKSAtPlxuICAgIFxuICAgIGJhc2UgPSBzbGFzaC5iYXNlbmFtZSBwXG4gICAgXG4gICAgaWYgc2xhc2gud2luKClcbiAgICAgICAgcmV0dXJuIHRydWUgaWYgYmFzZVswXSA9PSAnJCdcbiAgICAgICAgcmV0dXJuIHRydWUgaWYgYmFzZSA9PSAnZGVza3RvcC5pbmknXG4gICAgICAgIHJldHVybiB0cnVlIGlmIGJhc2UudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoICdudHVzZXInXG4gICAgaWYgbm90IGFyZ3MuYWxsXG4gICAgICAgIHJldHVybiB0cnVlIGlmIGJhc2VbMF0gPT0gJy4nXG4gICAgICAgIHJldHVybiBmYWxzZSBpZiBhcmdzLmFueVxuICAgICAgICBleHQgPSBzbGFzaC5leHQgcFxuICAgICAgICByZXR1cm4gdHJ1ZSBpZiBub3QgYXJncy5qcyAgICAgYW5kIGV4dCA9PSAnanMnXG4gICAgICAgIHJldHVybiB0cnVlIGlmIG5vdCBhcmdzLmpzb24gICBhbmQgZXh0ID09ICdqc29uJ1xuICAgICAgICByZXR1cm4gdHJ1ZSBpZiBub3QgYXJncy5ub29uICAgYW5kIGV4dCA9PSAnbm9vbidcbiAgICAgICAgcmV0dXJuIHRydWUgaWYgbm90IGFyZ3MuY29mZmVlIGFuZCBleHQgaW4gWydrb2ZmZWUnJ2NvZmZlZSddXG4gICAgZmFsc2VcblxuaWdub3JlRGlyID0gKHApIC0+XG4gICAgXG4gICAgaWYgbm90IGFyZ3MuYWxsXG4gICAgICAgIGJhc2UgPSBzbGFzaC5iYXNlbmFtZSBwXG4gICAgICAgIHJldHVybiB0cnVlIGlmIGJhc2VbMF0gPT0gJy4nXG4gICAgICAgIHJldHVybiB0cnVlIGlmIGJhc2UgPT0gJ25vZGVfbW9kdWxlcydcbiAgICBmYWxzZVxuICAgIFxuY29sb3JtYXAgPVxuICAgICdwdW5jdCc6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICd3MydcbiAgICAncHVuY3QgdGhpcyc6ICAgICAgICAgICAgICAgICAgICAgICAnYjMnXG4gICAgJ3B1bmN0IGNvbW1lbnQnOiAgICAgICAgICAgICAgICAgICAgJ3cxJyBcbiAgICAncHVuY3QgY29tbWVudCB0cmlwbGUnOiAgICAgICAgICAgICAndzEnIFxuICAgICdwdW5jdCByZWdleHAgc3RhcnQnOiAgICAgICAgICAgICAgICdtOCcgXG4gICAgJ3B1bmN0IHJlZ2V4cCBlbmQnOiAgICAgICAgICAgICAgICAgJ204JyBcbiAgICAncHVuY3QgcmVnZXhwJzogICAgICAgICAgICAgICAgICAgICAnbTInXG4gICAgJ3B1bmN0IHJlZ2V4cCB0cmlwbGUnOiAgICAgICAgICAgICAgJ20yJ1xuICAgICdwdW5jdCBzZW12ZXInOiAgICAgICAgICAgICAgICAgICAgICdyMicgXG4gICAgJ3B1bmN0IGVzY2FwZSByZWdleHAnOiAgICAgICAgICAgICAgJ20xJ1xuICAgICdwdW5jdCBlc2NhcGUgcmVnZXhwIHRyaXBsZSc6ICAgICAgICdtMSdcbiAgICAncHVuY3Qgc3RyaW5nIHNpbmdsZSc6ICAgICAgICAgICAgICAnZzEnIFxuICAgICdwdW5jdCBzdHJpbmcgc2luZ2xlIHRyaXBsZSc6ICAgICAgICdnMScgXG4gICAgJ3B1bmN0IHN0cmluZyBkb3VibGUnOiAgICAgICAgICAgICAgJ2cyJyBcbiAgICAncHVuY3Qgc3RyaW5nIGRvdWJsZSB0cmlwbGUnOiAgICAgICAnZzInIFxuICAgICdwdW5jdCBzdHJpbmcgaW50ZXJwb2xhdGlvbiBzdGFydCc6ICdnMSdcbiAgICAncHVuY3Qgc3RyaW5nIGludGVycG9sYXRpb24gZW5kJzogICAnZzEnXG4gICAgJ3B1bmN0IGRpY3Rpb25hcnknOiAgICAgICAgICAgICAgICAgJ3k4JyBcbiAgICAncHVuY3QgcHJvcGVydHknOiAgICAgICAgICAgICAgICAgICAneTEnIFxuICAgICdwdW5jdCByYW5nZSc6ICAgICAgICAgICAgICAgICAgICAgICdiNCcgXG4gICAgJ3B1bmN0IG1ldGhvZCc6ICAgICAgICAgICAgICAgICAgICAgJ3IyJ1xuICAgICdwdW5jdCBmdW5jdGlvbic6ICAgICAgICAgICAgICAgICAgICdyMSdcbiAgICAncHVuY3QgZnVuY3Rpb24gdGFpbCc6ICAgICAgICAgICAgICBbJ2I2JywgJ2JvbGQnLCAnQjEnXVxuICAgICdwdW5jdCBmdW5jdGlvbiBoZWFkJzogICAgICAgICAgICAgIFsnYjYnLCAnYm9sZCcsICdCMSddXG4gICAgJ3B1bmN0IGZ1bmN0aW9uIGJvdW5kIHRhaWwnOiAgICAgICAgWydyNScsICdib2xkJywgJ1IxJ11cbiAgICAncHVuY3QgZnVuY3Rpb24gYm91bmQgaGVhZCc6ICAgICAgICBbJ3I1JywgJ2JvbGQnLCAnUjEnXVxuICAgICdwdW5jdCBoMSc6ICAgICAgICAgICAgICAgICAgICAgICAgICd5MSdcbiAgICAndGV4dCBoMSc6ICAgICAgICAgICAgICAgICAgICAgICAgICAneTQnXG4gICAgJ3B1bmN0IGgyJzogICAgICAgICAgICAgICAgICAgICAgICAgJ3IxJ1xuICAgICd0ZXh0IGgyJzogICAgICAgICAgICAgICAgICAgICAgICAgICdyNCdcbiAgICAncHVuY3QgaDMnOiAgICAgICAgICAgICAgICAgICAgICAgICAnYjMnXG4gICAgJ3RleHQgaDMnOiAgICAgICAgICAgICAgICAgICAgICAgICAgJ2I4J1xuICAgICdwdW5jdCBoNCc6ICAgICAgICAgICAgICAgICAgICAgICAgICdiMidcbiAgICAndGV4dCBoNCc6ICAgICAgICAgICAgICAgICAgICAgICAgICAnYjYnXG4gICAgJ3B1bmN0IGg1JzogICAgICAgICAgICAgICAgICAgICAgICAgJ2IxJ1xuICAgICd0ZXh0IGg1JzogICAgICAgICAgICAgICAgICAgICAgICAgICdiNSdcbiAgICAnc3RyaW5nIHNpbmdsZSc6ICAgICAgICAgICAgICAgICAgICAnZzMnIFxuICAgICdzdHJpbmcgc2luZ2xlIHRyaXBsZSc6ICAgICAgICAgICAgICdnMycgXG4gICAgJ3N0cmluZyBkb3VibGUnOiAgICAgICAgICAgICAgICAgICAgJ2c0JyBcbiAgICAnc3RyaW5nIGRvdWJsZSB0cmlwbGUnOiAgICAgICAgICAgICAnZzQnIFxuICAgICduaWwnOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtMidcbiAgICAnb2JqJzogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAneTUnIFxuICAgICd0ZXh0JzogICAgICAgICAgICAgICAgICAgICAgICAgICAgICd3OCcgXG4gICAgJ3RleHQgdGhpcyc6ICAgICAgICAgICAgICAgICAgICAgICAgJ2I4JyBcbiAgICAndGV4dCByZWdleHAnOiAgICAgICAgICAgICAgICAgICAgICAnbTYnXG4gICAgJ3RleHQgcmVnZXhwIHRyaXBsZSc6ICAgICAgICAgICAgICAgJ202J1xuICAgICdyZXF1aXJlJzogICAgICAgICAgICAgICAgICAgICAgICAgICd3MycgXG4gICAgJ2tleXdvcmQnOiAgICAgICAgICAgICAgICAgICAgICAgICAgJ2I4JyBcbiAgICAnbnVtYmVyJzogICAgICAgICAgICAgICAgICAgICAgICAgICAnYjcnIFxuICAgICdudW1iZXIgaGV4JzogICAgICAgICAgICAgICAgICAgICAgICdjMycgXG4gICAgJ251bWJlciBmbG9hdCc6ICAgICAgICAgICAgICAgICAgICAgJ3I3JyBcbiAgICAncHVuY3QgbnVtYmVyIGZsb2F0JzogICAgICAgICAgICAgICAncjMnIFxuICAgICdzZW12ZXInOiAgICAgICAgICAgICAgICAgICAgICAgICAgICdyNScgXG4gICAgJ21vZHVsZSB0aGlzJzogICAgICAgICAgICAgICAgICAgICAgJ3kyJyBcbiAgICAnbW9kdWxlJzogICAgICAgICAgICAgICAgICAgICAgICAgICAneTYnIFxuICAgICdjbGFzcyc6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICd5NScgXG4gICAgJ3Byb3BlcnR5JzogICAgICAgICAgICAgICAgICAgICAgICAgJ3k2JyBcbiAgICAnZGljdGlvbmFyeSBrZXknOiAgICAgICAgICAgICAgICAgICAneTgnIFxuICAgICdwdW5jdCBmdW5jdGlvbiBjYWxsJzogICAgICAgICAgICAgICdyMicgXG4gICAgJ2Z1bmN0aW9uIGNhbGwgdGhpcyc6ICAgICAgICAgICAgICAgJ3IyJyBcbiAgICAnZnVuY3Rpb24gY2FsbCc6ICAgICAgICAgICAgICAgICAgICAncjUnIFxuICAgICdmdW5jdGlvbic6ICAgICAgICAgICAgICAgICAgICAgICAgICdyNCcgXG4gICAgJ21ldGhvZCc6ICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3I2J1xuICAgICdwdW5jdCBib2xkJzogICAgICAgICAgICAgICAgICAgICAgICdiMSdcbiAgICAndGV4dCBib2xkJzogICAgICAgICAgICAgICAgICAgICAgICAnYjcnXG4gICAgJ3RleHQgY29kZSc6ICAgICAgICAgICAgICAgICAgICAgICAgJ2I4J1xuICAgICdwdW5jdCBjb2RlJzogICAgICAgICAgICAgICAgICAgICAgICdiMScgXG4gICAgJ3B1bmN0IGNvZGUgdHJpcGxlJzogICAgICAgICAgICAgICAgJ2IxJyBcbiAgICAncHVuY3QgbWV0YSc6ICAgICAgICAgICAgICAgICAgICAgICAnZzEnIFxuICAgICdtZXRhJzogICAgICAgICAgICAgICAgICAgICAgICAgICAgICdnNCcgXG4gICAgJ2NvbW1lbnQnOiAgICAgICAgICAgICAgICAgICAgICAgICAgJ3czJ1xuICAgICdjb21tZW50IHRyaXBsZSc6ICAgICAgICAgICAgICAgICAgICd3NCdcbiAgICAnY29tbWVudCBoZWFkZXInOiAgICAgICAgICAgICAgICAgICBbJ2cxJywgJ0cxJ11cbiAgICAnY29tbWVudCB0cmlwbGUgaGVhZGVyJzogICAgICAgICAgICBbJ2cyJywgJ0cyJ11cbiAgICBcbmNvbG9yaXplID0gKGNodW5rKSAtPiBcblxuICAgIGlmIGNuID0gY29sb3JtYXBbY2h1bmsudmFsdWVdXG4gICAgICAgIGlmIGNuIGluc3RhbmNlb2YgQXJyYXlcbiAgICAgICAgICAgIHYgPSBjaHVuay5tYXRjaFxuICAgICAgICAgICAgZm9yIGMgaW4gY25cbiAgICAgICAgICAgICAgICB2ID0ga29sb3JbY10gdlxuICAgICAgICAgICAgcmV0dXJuIHZcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuIGtvbG9yW2NuXSBjaHVuay5tYXRjaFxuICAgICMgbG9nICc+PicrY2h1bmsudmFsdWUrJzw8J1xuICAgIGNodW5rLm1hdGNoXG4gICAgXG5vdXRwdXQgPSAocm5ncykgLT5cbiAgICBcbiAgICBjID0gMFxuICAgIGNscnpkID0gJydcbiAgICBmb3IgaSBpbiBbMC4uLnJuZ3MubGVuZ3RoXVxuICAgICAgICB3aGlsZSBjIDwgcm5nc1tpXS5zdGFydCBcbiAgICAgICAgICAgIGMrK1xuICAgICAgICAgICAgY2xyemQgKz0gJyAnXG4gICAgICAgIGNscnpkICs9IGNvbG9yaXplIHJuZ3NbaV1cbiAgICAgICAgYyArPSBybmdzW2ldLm1hdGNoLmxlbmd0aFxuICAgIGxvZyBjbHJ6ZFxuICAgIFxuIyAgMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICBcbiMgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4jIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwICAgIDAwMCAgICAgICAwMDAwMDAwMDAgIFxuIyAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICBcbiMgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgXG5cbk5FV0xJTkUgPSAvXFxyP1xcbi9cbnNlYXJjaCA9IChwYXRocykgLT5cbiAgICBcbiAgICByZWdleHAgPSBuZXcgUmVnRXhwIFwiKFwiICsgYXJncy5zdHJpbmdzLm1hcCgocyktPmtzdHIuZXNjYXBlUmVnZXhwKHMpKS5qb2luKCd8JykgKyBcIilcIiwgJ2cnXG5cbiAgICBwYXRocy5mb3JFYWNoIChwYXRoKSAtPlxuICAgICAgICBcbiAgICAgICAgaWYgc2xhc2guaXNEaXIgcGF0aFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBkaXIgPSBzbGFzaC5yZXNvbHZlIHBhdGhcbiAgICAgICAgICAgIGlmIG5vdCBpZ25vcmVEaXIgZGlyXG4gICAgICAgICAgICAgICAgc2VhcmNoIGZzLnJlYWRkaXJTeW5jKGRpcikubWFwIChwKSAtPiBzbGFzaC5qb2luIGRpciwgcFxuICAgICAgICAgICAgXG4gICAgICAgIGVsc2UgaWYgc2xhc2guaXNUZXh0IHBhdGhcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZmlsZSA9IHNsYXNoLnJlc29sdmUgcGF0aFxuICAgICAgICAgICAgaWYgbm90IGlnbm9yZUZpbGUgZmlsZVxuICAgICAgICAgICAgICAgIHRleHQgPSBzbGFzaC5yZWFkVGV4dCBmaWxlXG4gICAgICAgICAgICAgICAgbGluZXMgPSB0ZXh0LnNwbGl0IE5FV0xJTkVcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBybmdzID0ga2xvci5kaXNzZWN0IGxpbmVzLCAnY29mZmVlJ1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGZvciBpbmRleCBpbiBbMC4uLmxpbmVzLmxlbmd0aF1cbiAgICAgICAgICAgICAgICAgICAgbGluZSA9IGxpbmVzW2luZGV4XVxuICAgICAgICAgICAgICAgICAgICBpZiBsaW5lLnNlYXJjaChyZWdleHApID49IDBcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCBybmdzW2luZGV4XVxuICAgICAgICAgICAgXG4jIDAwICAgICAwMCAgIDAwMDAwMDAgICAwMDAgIDAwMCAgIDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDBcbiMgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAgMDAwIDAgMDAwXG4jIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgMDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDBcblxua2xvZyAnYXJnczonIGFyZ3MgaWYgYXJncy5kZWJ1Z1xuXG5zZWFyY2ggW2FyZ3MucGF0aF1cbiJdfQ==
//# sourceURL=../coffee/krep.coffee
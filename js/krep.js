// koffee 0.45.0

/*
000   000  00000000   00000000  00000000 
000  000   000   000  000       000   000
0000000    0000000    0000000   00000000 
000  000   000   000  000       000      
000   000  000   000  00000000  000
 */
var LI, NEWLINE, _, args, colorize, fs, hasExt, highlightRanges, ignoreDir, ignoreFile, karg, klog, klor, kolor, kstr, noon, output, ref, search, slash, sliceRanges, valid;

ref = require('kxk'), slash = ref.slash, noon = ref.noon, karg = ref.karg, klog = ref.klog, kstr = ref.kstr, valid = ref.valid, fs = ref.fs, _ = ref._;

klor = require('klor');

kolor = klor.kolor;

kolor.globalize();

args = karg("krep\n    strings   . ? text to search for                . **\n    header    . ? print file headers                . = true  . - H\n    recurse   . ? recurse into subdirs              . = true  . - R\n    path      . ? file or folder to search in       . = |.|\n    ext       . ? search only files with extension  . = ||\n    coffee    . ? search only coffeescript files    . = false\n    noon      . ? search only noon files            . = false\n    js        . ? search only javascript files      . = false\n    cpp       . ? search only cpp files             . = false . - C\n    json      . ? search only json files            . = false . - J\n    numbers   . ? prefix with line numbers          . = false . - N\n    regexp    . ? strings are regexp patterns       . = false\n    dot       . ? search dot files                  . = false\n    debug                                           . = false . - D\n\nversion       " + (require(__dirname + "/../package.json").version));

if (args.path === '.' && args.strings.length) {
    if (slash.exists(args.strings[0])) {
        if (args.strings.length > 1 || slash.isFile(args.strings[0])) {
            args.path = args.strings.shift();
        }
    } else if (slash.exists(args.strings.slice(-1)[0])) {
        args.path = args.strings.pop();
    }
}

args.path = slash.resolve(args.path);

if (valid(args.__ignored)) {
    args.strings = args.strings.concat(args.__ignored);
}

hasExt = ['coffee', 'noon', 'json', 'js', 'cpp'].map(function(t) {
    return args[t];
}).filter(function(b) {
    return b;
}).length > 0;

if (!hasExt) {
    args.any = true;
}

ignoreFile = function(p) {
    var base, ext;
    base = slash.basename(p);
    ext = slash.ext(p);
    if (slash.win()) {
        if (base[0] === '$') {
            return true;
        }
        if (base === 'desktop.ini') {
            return true;
        }
        if (base.toLowerCase().startsWith('ntuser')) {
            return true;
        }
    }
    if (p === args.path) {
        return false;
    }
    if (args.ext) {
        return ext !== args.ext;
    }
    if (base[0] === '.' && !args.dot) {
        return true;
    }
    if (args.any) {
        return false;
    }
    if (args.js && ext === 'js') {
        return false;
    }
    if (args.json && ext === 'json') {
        return false;
    }
    if (args.noon && ext === 'noon') {
        return false;
    }
    if (args.cpp && (ext === 'cpp' || ext === 'hpp' || ext === 'h')) {
        return false;
    }
    if (args.coffee && (ext === 'koffee' || ext === 'coffee')) {
        return false;
    }
    return true;
};

ignoreDir = function(p) {
    var base, ext;
    if (p === args.path) {
        return false;
    }
    base = slash.basename(p);
    ext = slash.ext(p);
    if (base[0] === '.') {
        return true;
    }
    if (base === 'node_modules') {
        return true;
    }
    if (ext === 'app') {
        return true;
    }
    return false;
};

NEWLINE = /\r?\n/;

search = function(paths) {
    var dump, regexp;
    if (args.strings.length) {
        if (args.regexp) {
            regexp = new RegExp("(" + args.strings.join('|') + ")", 'g');
        } else {
            regexp = new RegExp("(" + args.strings.map(function(s) {
                return kstr.escapeRegexp(s);
            }).join('|') + ")", 'g');
        }
    } else {
        dump = true;
    }
    return paths.forEach(function(path) {
        var dir, file, header, highlights, index, j, line, lines, printHeader, ref1, results, rngs, sliced, text;
        if (slash.isDir(path)) {
            dir = slash.resolve(path);
            if (!ignoreDir(dir)) {
                return search(fs.readdirSync(dir).map(function(p) {
                    return slash.join(dir, p);
                }));
            }
        } else if (slash.isText(path)) {
            file = slash.resolve(path);
            if (!ignoreFile(file)) {
                header = false;
                printHeader = function() {
                    var rel;
                    header = true;
                    if (args.header) {
                        rel = slash.relative(file, process.cwd());
                        console.log('');
                        console.log(W1(y5(' â–¸ ' + g2(slash.dirname(rel) + '/' + y5(slash.base(rel) + y1('.' + slash.ext(rel) + ' '))))));
                        return console.log('');
                    }
                };
                text = slash.readText(file);
                lines = text.split(NEWLINE);
                rngs = klor.dissect(lines, slash.ext(file));
                results = [];
                for (index = j = 0, ref1 = lines.length; 0 <= ref1 ? j < ref1 : j > ref1; index = 0 <= ref1 ? ++j : --j) {
                    line = lines[index];
                    if (line.startsWith('//# sourceMappingURL')) {
                        continue;
                    }
                    if (dump) {
                        if (!header) {
                            printHeader();
                        }
                        results.push(output(rngs[index], index + 1, []));
                    } else {
                        if (line.search(regexp) >= 0) {
                            if (!header) {
                                printHeader();
                            }
                            highlights = highlightRanges(line, regexp);
                            if (!(highlights.length)) {
                                console.log('[33m[93mkrep[33m[2m.[22m[2mcoffee[22m[39m[2m[34m:[39m[22m[94m150[39m', '[1m[97massertion failure![39m[22m');

                            };
                            sliced = sliceRanges(rngs[index], highlights);
                            results.push(output(sliced, index + 1, highlights));
                        } else {
                            results.push(void 0);
                        }
                    }
                }
                return results;
            }
        }
    });
};

highlightRanges = function(line, regexp) {
    var m, ranges;
    ranges = [];
    while (m = regexp.exec(line)) {
        ranges.push({
            start: m.index,
            end: m.index + m[0].length - 1
        });
    }
    return ranges;
};

sliceRanges = function(ranges, highlights) {
    var after, before, h, i, range, ref1, ref2, split;
    h = 0;
    i = 0;
    while (i < ranges.length) {
        range = ranges[i];
        while (h < highlights.length && range.start > highlights[h].end) {
            h++;
        }
        if (h >= highlights.length) {
            return ranges;
        }
        split = 0;
        if ((range.start < (ref1 = highlights[h].start) && ref1 <= range.start + range.length)) {
            split = highlights[h].start - range.start;
        } else if ((range.start <= (ref2 = highlights[h].end) && ref2 < range.start + range.length)) {
            split = highlights[h].end - range.start + 1;
        }
        if (split) {
            before = _.clone(range);
            after = _.clone(range);
            before.match = range.match.slice(0, split);
            before.length = before.match.length;
            after.match = range.match.slice(split);
            after.length = after.match.length;
            after.start = range.start + before.length;
            ranges.splice(i, 1, before, after);
        }
        i++;
    }
    return ranges;
};

output = function(rngs, number, highlights) {
    var c, clrzd, h, highlight, i, j, numstr, ref1;
    clrzd = '';
    if (args.numbers) {
        numstr = String(number);
        clrzd += w1(numstr) + _.pad('', 4 - numstr.length);
    }
    c = 0;
    h = 0;
    highlight = function(s) {
        if (h < highlights.length) {
            if (c >= highlights[h].start && c <= highlights[h].end) {
                return inverse(s);
            }
            while (h < highlights.length && c > highlights[h].end) {
                h++;
            }
        }
        return s;
    };
    for (i = j = 0, ref1 = rngs.length; 0 <= ref1 ? j < ref1 : j > ref1; i = 0 <= ref1 ? ++j : --j) {
        while (c < rngs[i].start) {
            clrzd += highlight(' ');
            c++;
        }
        clrzd += highlight(colorize(rngs[i]));
        c += rngs[i].match.length;
    }
    return console.log(clrzd);
};

LI = /(\sli\d\s|\sh\d\s)/;

colorize = function(chunk) {
    var c, cn, j, len, v;
    if (cn = kolor.map[chunk.value]) {
        if (cn instanceof Array) {
            v = chunk.match;
            for (j = 0, len = cn.length; j < len; j++) {
                c = cn[j];
                v = kolor[c](v);
            }
            return v;
        } else {
            return kolor[cn](chunk.match);
        }
    }
    if (chunk.value.endsWith('file')) {
        return w8(chunk.match);
    } else if (chunk.value.endsWith('ext')) {
        return w3(chunk.match);
    } else if (chunk.value.startsWith('punct')) {
        if (LI.test(chunk.value)) {
            return colorize({
                match: chunk.match,
                value: chunk.value.replace(LI, ' ')
            });
        } else {
            return w2(chunk.match);
        }
    } else {
        if (LI.test(chunk.value)) {
            return colorize({
                match: chunk.match,
                value: chunk.value.replace(LI, ' ')
            });
        } else {
            return chunk.match;
        }
    }
};

if (args.debug) {
    klog(noon.stringify(args, {
        colors: true
    }));
}

search([args.path]);

console.log('');

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia3JlcC5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUE7O0FBUUEsTUFBa0QsT0FBQSxDQUFRLEtBQVIsQ0FBbEQsRUFBRSxpQkFBRixFQUFTLGVBQVQsRUFBZSxlQUFmLEVBQXFCLGVBQXJCLEVBQTJCLGVBQTNCLEVBQWlDLGlCQUFqQyxFQUF3QyxXQUF4QyxFQUE0Qzs7QUFFNUMsSUFBQSxHQUFRLE9BQUEsQ0FBUSxNQUFSOztBQUVSLEtBQUEsR0FBUSxJQUFJLENBQUM7O0FBQ2IsS0FBSyxDQUFDLFNBQU4sQ0FBQTs7QUFFQSxJQUFBLEdBQU8sSUFBQSxDQUFLLG82QkFBQSxHQWlCRyxDQUFDLE9BQUEsQ0FBVyxTQUFELEdBQVcsa0JBQXJCLENBQXVDLENBQUMsT0FBekMsQ0FqQlI7O0FBb0JQLElBQUcsSUFBSSxDQUFDLElBQUwsS0FBYSxHQUFiLElBQXFCLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBckM7SUFDSSxJQUFHLEtBQUssQ0FBQyxNQUFOLENBQWEsSUFBSSxDQUFDLE9BQVEsQ0FBQSxDQUFBLENBQTFCLENBQUg7UUFDSSxJQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBYixHQUFzQixDQUF0QixJQUEyQixLQUFLLENBQUMsTUFBTixDQUFhLElBQUksQ0FBQyxPQUFRLENBQUEsQ0FBQSxDQUExQixDQUE5QjtZQUNJLElBQUksQ0FBQyxJQUFMLEdBQVksSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFiLENBQUEsRUFEaEI7U0FESjtLQUFBLE1BR0ssSUFBRyxLQUFLLENBQUMsTUFBTixDQUFhLElBQUksQ0FBQyxPQUFRLFVBQUUsQ0FBQSxDQUFBLENBQTVCLENBQUg7UUFDRCxJQUFJLENBQUMsSUFBTCxHQUFZLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBYixDQUFBLEVBRFg7S0FKVDs7O0FBT0EsSUFBSSxDQUFDLElBQUwsR0FBWSxLQUFLLENBQUMsT0FBTixD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QXJCLENBQUwsRUFBQTs7O0FBRUEsTUFBQSxDQUFPLENBQUMsSUFBSSxDQUFDLElBQU4sQ0FBUDs7QUFBa0IsT0FBQSxDQUNsQixHQURrQixDQUNkLEVBRGMiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbjAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMDAgXG4wMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMFxuMDAwMDAwMCAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwMCBcbjAwMCAgMDAwICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgICAgIFxuIyMjXG5cbnsgc2xhc2gsIG5vb24sIGthcmcsIGtsb2csIGtzdHIsIHZhbGlkLCBmcywgXyB9ID0gcmVxdWlyZSAna3hrJ1xuXG5rbG9yICA9IHJlcXVpcmUgJ2tsb3InXG5cbmtvbG9yID0ga2xvci5rb2xvclxua29sb3IuZ2xvYmFsaXplKClcblxuYXJncyA9IGthcmcgXCJcIlwiXG5rcmVwXG4gICAgc3RyaW5ncyAgIC4gPyB0ZXh0IHRvIHNlYXJjaCBmb3IgICAgICAgICAgICAgICAgLiAqKlxuICAgIGhlYWRlciAgICAuID8gcHJpbnQgZmlsZSBoZWFkZXJzICAgICAgICAgICAgICAgIC4gPSB0cnVlICAuIC0gSFxuICAgIHJlY3Vyc2UgICAuID8gcmVjdXJzZSBpbnRvIHN1YmRpcnMgICAgICAgICAgICAgIC4gPSB0cnVlICAuIC0gUlxuICAgIHBhdGggICAgICAuID8gZmlsZSBvciBmb2xkZXIgdG8gc2VhcmNoIGluICAgICAgIC4gPSB8LnxcbiAgICBleHQgICAgICAgLiA/IHNlYXJjaCBvbmx5IGZpbGVzIHdpdGggZXh0ZW5zaW9uICAuID0gfHxcbiAgICBjb2ZmZWUgICAgLiA/IHNlYXJjaCBvbmx5IGNvZmZlZXNjcmlwdCBmaWxlcyAgICAuID0gZmFsc2VcbiAgICBub29uICAgICAgLiA/IHNlYXJjaCBvbmx5IG5vb24gZmlsZXMgICAgICAgICAgICAuID0gZmFsc2VcbiAgICBqcyAgICAgICAgLiA/IHNlYXJjaCBvbmx5IGphdmFzY3JpcHQgZmlsZXMgICAgICAuID0gZmFsc2VcbiAgICBjcHAgICAgICAgLiA/IHNlYXJjaCBvbmx5IGNwcCBmaWxlcyAgICAgICAgICAgICAuID0gZmFsc2UgLiAtIENcbiAgICBqc29uICAgICAgLiA/IHNlYXJjaCBvbmx5IGpzb24gZmlsZXMgICAgICAgICAgICAuID0gZmFsc2UgLiAtIEpcbiAgICBudW1iZXJzICAgLiA/IHByZWZpeCB3aXRoIGxpbmUgbnVtYmVycyAgICAgICAgICAuID0gZmFsc2UgLiAtIE5cbiAgICByZWdleHAgICAgLiA/IHN0cmluZ3MgYXJlIHJlZ2V4cCBwYXR0ZXJucyAgICAgICAuID0gZmFsc2VcbiAgICBkb3QgICAgICAgLiA/IHNlYXJjaCBkb3QgZmlsZXMgICAgICAgICAgICAgICAgICAuID0gZmFsc2VcbiAgICBkZWJ1ZyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuID0gZmFsc2UgLiAtIERcblxudmVyc2lvbiAgICAgICAje3JlcXVpcmUoXCIje19fZGlybmFtZX0vLi4vcGFja2FnZS5qc29uXCIpLnZlcnNpb259XG5cIlwiXCJcblxuaWYgYXJncy5wYXRoID09ICcuJyBhbmQgYXJncy5zdHJpbmdzLmxlbmd0aFxuICAgIGlmIHNsYXNoLmV4aXN0cyBhcmdzLnN0cmluZ3NbMF1cbiAgICAgICAgaWYgYXJncy5zdHJpbmdzLmxlbmd0aCA+IDEgb3Igc2xhc2guaXNGaWxlIGFyZ3Muc3RyaW5nc1swXVxuICAgICAgICAgICAgYXJncy5wYXRoID0gYXJncy5zdHJpbmdzLnNoaWZ0KClcbiAgICBlbHNlIGlmIHNsYXNoLmV4aXN0cyBhcmdzLnN0cmluZ3NbLTFdXG4gICAgICAgIGFyZ3MucGF0aCA9IGFyZ3Muc3RyaW5ncy5wb3AoKVxuICAgICAgICBcbmFyZ3MucGF0aCA9IHNsYXNoLnJlc29sdmUgYXJncy5wYXRoXG5cbmlmIHZhbGlkIGFyZ3MuX19pZ25vcmVkXG4gICAgYXJncy5zdHJpbmdzID0gYXJncy5zdHJpbmdzLmNvbmNhdCBhcmdzLl9faWdub3JlZFxuICAgIFxuaGFzRXh0ID0gWydjb2ZmZWUnJ25vb24nJ2pzb24nJ2pzJydjcHAnXVxuICAgIC5tYXAgKHQpIC0+IGFyZ3NbdF1cbiAgICAuZmlsdGVyIChiKSAtPiBiXG4gICAgLmxlbmd0aCA+IDBcbiAgICBcbmlmIG5vdCBoYXNFeHQgdGhlbiBhcmdzLmFueSA9IHRydWVcblxuIyAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMDAgIFxuIyAwMDAgIDAwMCAgICAgICAgMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuIyAwMDAgIDAwMCAgMDAwMCAgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIFxuIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuIyAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIFxuXG5pZ25vcmVGaWxlID0gKHApIC0+XG4gICAgXG4gICAgYmFzZSA9IHNsYXNoLmJhc2VuYW1lIHBcbiAgICBleHQgID0gc2xhc2guZXh0IHBcbiAgICBcbiAgICBpZiBzbGFzaC53aW4oKVxuICAgICAgICByZXR1cm4gdHJ1ZSBpZiBiYXNlWzBdID09ICckJ1xuICAgICAgICByZXR1cm4gdHJ1ZSBpZiBiYXNlID09ICdkZXNrdG9wLmluaSdcbiAgICAgICAgcmV0dXJuIHRydWUgaWYgYmFzZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGggJ250dXNlcidcbiAgICBcbiAgICByZXR1cm4gZmFsc2UgaWYgcCA9PSBhcmdzLnBhdGhcbiAgICBpZiBhcmdzLmV4dCB0aGVuIHJldHVybiBleHQgIT0gYXJncy5leHRcbiAgICByZXR1cm4gdHJ1ZSBpZiBiYXNlWzBdID09ICcuJyBhbmQgbm90IGFyZ3MuZG90XG4gICAgcmV0dXJuIGZhbHNlIGlmIGFyZ3MuYW55XG4gICAgcmV0dXJuIGZhbHNlIGlmIGFyZ3MuanMgICAgIGFuZCBleHQgPT0gJ2pzJ1xuICAgIHJldHVybiBmYWxzZSBpZiBhcmdzLmpzb24gICBhbmQgZXh0ID09ICdqc29uJ1xuICAgIHJldHVybiBmYWxzZSBpZiBhcmdzLm5vb24gICBhbmQgZXh0ID09ICdub29uJ1xuICAgIHJldHVybiBmYWxzZSBpZiBhcmdzLmNwcCAgICBhbmQgZXh0IGluIFsnY3BwJywgJ2hwcCcsICdoJ11cbiAgICByZXR1cm4gZmFsc2UgaWYgYXJncy5jb2ZmZWUgYW5kIGV4dCBpbiBbJ2tvZmZlZScnY29mZmVlJ11cbiAgICByZXR1cm4gdHJ1ZVxuXG5pZ25vcmVEaXIgPSAocCkgLT5cbiAgICBcbiAgICByZXR1cm4gZmFsc2UgaWYgcCA9PSBhcmdzLnBhdGhcbiAgICBiYXNlID0gc2xhc2guYmFzZW5hbWUgcFxuICAgIGV4dCAgPSBzbGFzaC5leHQgcFxuICAgIHJldHVybiB0cnVlIGlmIGJhc2VbMF0gPT0gJy4nXG4gICAgcmV0dXJuIHRydWUgaWYgYmFzZSA9PSAnbm9kZV9tb2R1bGVzJ1xuICAgIHJldHVybiB0cnVlIGlmIGV4dCAgPT0gJ2FwcCdcbiAgICBmYWxzZVxuICAgICAgICAgICAgICAgIFxuIyAgMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICBcbiMgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4jIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwICAgIDAwMCAgICAgICAwMDAwMDAwMDAgIFxuIyAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICBcbiMgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgXG5cbk5FV0xJTkUgPSAvXFxyP1xcbi9cblxuc2VhcmNoID0gKHBhdGhzKSAtPlxuICAgIFxuICAgIGlmIGFyZ3Muc3RyaW5ncy5sZW5ndGhcbiAgICAgICAgaWYgYXJncy5yZWdleHBcbiAgICAgICAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAgXCIoXCIgKyBhcmdzLnN0cmluZ3Muam9pbignfCcpICsgXCIpXCIsICdnJ1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZWdleHAgPSBuZXcgUmVnRXhwIFwiKFwiICsgYXJncy5zdHJpbmdzLm1hcCgocykgLT4ga3N0ci5lc2NhcGVSZWdleHAocykpLmpvaW4oJ3wnKSArIFwiKVwiLCAnZydcbiAgICBlbHNlXG4gICAgICAgIGR1bXAgPSB0cnVlXG5cbiAgICBwYXRocy5mb3JFYWNoIChwYXRoKSAtPlxuICAgICAgICBcbiAgICAgICAgaWYgc2xhc2guaXNEaXIgcGF0aFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBkaXIgPSBzbGFzaC5yZXNvbHZlIHBhdGhcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgbm90IGlnbm9yZURpciBkaXJcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBzZWFyY2ggZnMucmVhZGRpclN5bmMoZGlyKS5tYXAgKHApIC0+IHNsYXNoLmpvaW4gZGlyLCBwXG4gICAgICAgICAgICBcbiAgICAgICAgZWxzZSBpZiBzbGFzaC5pc1RleHQgcGF0aFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBmaWxlID0gc2xhc2gucmVzb2x2ZSBwYXRoXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIG5vdCBpZ25vcmVGaWxlIGZpbGVcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBoZWFkZXIgPSBmYWxzZVxuICAgICAgICAgICAgICAgIHByaW50SGVhZGVyID0gLT5cbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyID0gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICBpZiBhcmdzLmhlYWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVsID0gc2xhc2gucmVsYXRpdmUgZmlsZSwgcHJvY2Vzcy5jd2QoKVxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nICcnXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2cgVzEgeTUgJyDilrggJyArIGcyIHNsYXNoLmRpcm5hbWUocmVsKSArICcvJyArIHk1IHNsYXNoLmJhc2UocmVsKSArIHkxICcuJyArIHNsYXNoLmV4dChyZWwpICsgJyAnXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2cgJydcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0ZXh0ICA9IHNsYXNoLnJlYWRUZXh0IGZpbGVcbiAgICAgICAgICAgICAgICBsaW5lcyA9IHRleHQuc3BsaXQgTkVXTElORVxuICAgICAgICAgICAgICAgIHJuZ3MgID0ga2xvci5kaXNzZWN0IGxpbmVzLCBzbGFzaC5leHQgZmlsZVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGZvciBpbmRleCBpbiBbMC4uLmxpbmVzLmxlbmd0aF1cbiAgICAgICAgICAgICAgICAgICAgbGluZSA9IGxpbmVzW2luZGV4XVxuICAgICAgICAgICAgICAgICAgICBpZiBsaW5lLnN0YXJ0c1dpdGggJy8vIyBzb3VyY2VNYXBwaW5nVVJMJ1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcbiAgICAgICAgICAgICAgICAgICAgaWYgZHVtcFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRIZWFkZXIoKSBpZiBub3QgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgcm5nc1tpbmRleF0sIGluZGV4KzEsIFtdXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxpbmUuc2VhcmNoKHJlZ2V4cCkgPj0gMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50SGVhZGVyKCkgaWYgbm90IGhlYWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodHMgPSBoaWdobGlnaHRSYW5nZXMgbGluZSwgcmVnZXhwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAg4pa4YXNzZXJ0IGhpZ2hsaWdodHMubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VkID0gc2xpY2VSYW5nZXMgcm5nc1tpbmRleF0sIGhpZ2hsaWdodHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgc2xpY2VkLCBpbmRleCsxLCBoaWdobGlnaHRzXG5cbiMgMDAwICAgMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMDBcbiMgMDAwICAgMDAwICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAgICAwMDAgICBcbiMgMDAwMDAwMDAwICAwMDAgIDAwMCAgMDAwMCAgMDAwMDAwMDAwICAwMDAgICAgICAwMDAgIDAwMCAgMDAwMCAgMDAwMDAwMDAwICAgICAwMDAgICBcbiMgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgICAwMDAgICBcblxuaGlnaGxpZ2h0UmFuZ2VzID0gKGxpbmUsIHJlZ2V4cCkgLT5cbiAgICBcbiAgICByYW5nZXMgPSBbXVxuICAgIHdoaWxlIG0gPSByZWdleHAuZXhlYyBsaW5lXG4gICAgICAgIHJhbmdlcy5wdXNoIHN0YXJ0Om0uaW5kZXgsIGVuZDptLmluZGV4K21bMF0ubGVuZ3RoLTFcbiAgICByYW5nZXNcbiAgICBcbnNsaWNlUmFuZ2VzID0gKHJhbmdlcywgaGlnaGxpZ2h0cykgLT5cblxuICAgIGggPSAwXG4gICAgaSA9IDBcbiAgICB3aGlsZSBpIDwgcmFuZ2VzLmxlbmd0aFxuICAgICAgICByYW5nZSA9IHJhbmdlc1tpXVxuICAgICAgICB3aGlsZSBoIDwgaGlnaGxpZ2h0cy5sZW5ndGggYW5kIHJhbmdlLnN0YXJ0ID4gaGlnaGxpZ2h0c1toXS5lbmRcbiAgICAgICAgICAgIGgrK1xuICAgICAgICBcbiAgICAgICAgaWYgaCA+PSBoaWdobGlnaHRzLmxlbmd0aCB0aGVuIHJldHVybiByYW5nZXNcblxuICAgICAgICBzcGxpdCA9IDBcbiAgICAgICAgaWYgcmFuZ2Uuc3RhcnQgPCBoaWdobGlnaHRzW2hdLnN0YXJ0IDw9IHJhbmdlLnN0YXJ0K3JhbmdlLmxlbmd0aFxuICAgICAgICAgICAgc3BsaXQgID0gaGlnaGxpZ2h0c1toXS5zdGFydCAtIHJhbmdlLnN0YXJ0XG4gICAgICAgIGVsc2UgaWYgcmFuZ2Uuc3RhcnQgPD0gaGlnaGxpZ2h0c1toXS5lbmQgPCByYW5nZS5zdGFydCtyYW5nZS5sZW5ndGhcbiAgICAgICAgICAgIHNwbGl0ID0gaGlnaGxpZ2h0c1toXS5lbmQgLSByYW5nZS5zdGFydCArIDFcblxuICAgICAgICBpZiBzcGxpdFxuICAgICAgICAgICAgYmVmb3JlID0gXy5jbG9uZSByYW5nZVxuICAgICAgICAgICAgYWZ0ZXIgID0gXy5jbG9uZSByYW5nZVxuICAgICAgICAgICAgYmVmb3JlLm1hdGNoICA9IHJhbmdlLm1hdGNoWy4uLnNwbGl0XVxuICAgICAgICAgICAgYmVmb3JlLmxlbmd0aCA9IGJlZm9yZS5tYXRjaC5sZW5ndGhcbiAgICAgICAgICAgIGFmdGVyLm1hdGNoICAgPSByYW5nZS5tYXRjaFtzcGxpdC4uLl1cbiAgICAgICAgICAgIGFmdGVyLmxlbmd0aCAgPSBhZnRlci5tYXRjaC5sZW5ndGhcbiAgICAgICAgICAgIGFmdGVyLnN0YXJ0ICAgPSByYW5nZS5zdGFydCArIGJlZm9yZS5sZW5ndGhcbiAgICAgICAgICAgIHJhbmdlcy5zcGxpY2UgaSwgMSwgYmVmb3JlLCBhZnRlclxuICAgICAgICBpKytcbiAgICByYW5nZXNcbiAgICAgICAgICAgIFxuIyAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMDAwMDAwICAgMDAwICAgMDAwICAgICAwMDAgICAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiMgIDAwMDAwMDAgICAgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwICAgICAgICAgMDAwMDAwMCAgICAgIDAwMCAgICAgXG5cbm91dHB1dCA9IChybmdzLCBudW1iZXIsIGhpZ2hsaWdodHMpIC0+XG4gICAgXG4gICAgY2xyemQgPSAnJ1xuICAgIFxuICAgIGlmIGFyZ3MubnVtYmVyc1xuICAgICAgICBudW1zdHIgPSBTdHJpbmcgbnVtYmVyXG4gICAgICAgIGNscnpkICs9IHcxKG51bXN0cikgKyBfLnBhZCAnJywgNC1udW1zdHIubGVuZ3RoXG4gICAgICAgIFxuICAgIGMgPSAwXG4gICAgaCA9IDBcbiAgICBoaWdobGlnaHQgPSAocykgLT5cbiAgICAgICAgaWYgaCA8IGhpZ2hsaWdodHMubGVuZ3RoXG4gICAgICAgICAgICBpZiBjID49IGhpZ2hsaWdodHNbaF0uc3RhcnQgYW5kIGMgPD0gaGlnaGxpZ2h0c1toXS5lbmRcbiAgICAgICAgICAgICAgICByZXR1cm4gaW52ZXJzZSBzXG4gICAgICAgICAgICB3aGlsZSBoIDwgaGlnaGxpZ2h0cy5sZW5ndGggYW5kIGMgPiBoaWdobGlnaHRzW2hdLmVuZFxuICAgICAgICAgICAgICAgIGgrK1xuICAgICAgICBzXG4gICAgXG4gICAgZm9yIGkgaW4gWzAuLi5ybmdzLmxlbmd0aF1cbiAgICAgICAgd2hpbGUgYyA8IHJuZ3NbaV0uc3RhcnQgXG4gICAgICAgICAgICBjbHJ6ZCArPSBoaWdobGlnaHQgJyAnXG4gICAgICAgICAgICBjKytcbiAgICAgICAgY2xyemQgKz0gaGlnaGxpZ2h0IGNvbG9yaXplIHJuZ3NbaV1cbiAgICAgICAgYyArPSBybmdzW2ldLm1hdGNoLmxlbmd0aFxuICAgICAgICBcbiAgICBsb2cgY2xyemRcblxuIyAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAgICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgXG4jIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgIDAwMCAgIDAwMCAgICAgICBcbiMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMCAgICAwMDAgICAgMDAwMDAwMCAgIFxuIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgICAgXG4jICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICBcblxuTEkgPSAvKFxcc2xpXFxkXFxzfFxcc2hcXGRcXHMpL1xuXG5jb2xvcml6ZSA9IChjaHVuaykgLT4gXG4gICAgXG4gICAgaWYgY24gPSBrb2xvci5tYXBbY2h1bmsudmFsdWVdXG4gICAgICAgIGlmIGNuIGluc3RhbmNlb2YgQXJyYXlcbiAgICAgICAgICAgIHYgPSBjaHVuay5tYXRjaFxuICAgICAgICAgICAgZm9yIGMgaW4gY25cbiAgICAgICAgICAgICAgICB2ID0ga29sb3JbY10gdlxuICAgICAgICAgICAgcmV0dXJuIHZcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuIGtvbG9yW2NuXSBjaHVuay5tYXRjaFxuICAgICAgICAgICAgXG4gICAgXG4gICAgaWYgY2h1bmsudmFsdWUuZW5kc1dpdGggJ2ZpbGUnXG4gICAgICAgIHc4IGNodW5rLm1hdGNoXG4gICAgZWxzZSBpZiBjaHVuay52YWx1ZS5lbmRzV2l0aCAnZXh0J1xuICAgICAgICB3MyBjaHVuay5tYXRjaFxuICAgIGVsc2UgaWYgY2h1bmsudmFsdWUuc3RhcnRzV2l0aCAncHVuY3QnXG4gICAgICAgIGlmIExJLnRlc3QgY2h1bmsudmFsdWVcbiAgICAgICAgICAgIGNvbG9yaXplIG1hdGNoOmNodW5rLm1hdGNoLCB2YWx1ZTpjaHVuay52YWx1ZS5yZXBsYWNlIExJLCAnICdcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgIyBsb2cgXCI+Pj4je2NodW5rLnZhbHVlfTw8PCAje2NodW5rLm1hdGNofVwiXG4gICAgICAgICAgICB3MiBjaHVuay5tYXRjaFxuICAgIGVsc2VcbiAgICAgICAgaWYgTEkudGVzdCBjaHVuay52YWx1ZVxuICAgICAgICAgICAgY29sb3JpemUgbWF0Y2g6Y2h1bmsubWF0Y2gsIHZhbHVlOmNodW5rLnZhbHVlLnJlcGxhY2UgTEksICcgJ1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICAjIGxvZyBcIj4+PiN7Y2h1bmsudmFsdWV9PDw8ICN7Y2h1bmsubWF0Y2h9XCJcbiAgICAgICAgICAgIGNodW5rLm1hdGNoXG4gICAgXG5rbG9nIG5vb24uc3RyaW5naWZ5KGFyZ3MsIGNvbG9yczp0cnVlKSBpZiBhcmdzLmRlYnVnXG5cbnNlYXJjaCBbYXJncy5wYXRoXVxubG9nICcnXG4iXX0=
//# sourceURL=../coffee/krep.coffee